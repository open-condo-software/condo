query getSubscriptionContext($id: ID!) {
    subscriptionContext: SubscriptionContext(where: { id: $id }) {
        id
        organization {
            id
            name
        }
        subscriptionPlan {
            id
            name
            description
            organizationType
            trialDays
            priority
            news
            marketplace
            support
            ai
            disabledB2BApps
            disabledB2CApps
            isHidden
        }
        startAt
        endAt
        pricingRule {
            id
            name
            price
            currencyCode
            period
        }
        frozenPricingRule
        isTrial
        daysRemaining
        dv
        sender {
            dv
            fingerprint
        }
        v
        deletedAt
        newId
        createdBy {
            id
            name
        }
        updatedBy {
            id
            name
        }
        createdAt
        updatedAt
    }
}

query getOrganizationTrialSubscriptions($organizationId: ID!) {
    trialSubscriptions: allSubscriptionContexts(
        where: {
            organization: { id: $organizationId }
            isTrial: true
        }
        sortBy: [createdAt_DESC]
    ) {
        id
        subscriptionPlan {
            id
            name
        }
        isTrial
        startAt
        daysRemaining
        endAt
        createdAt
    }
}

query getLastExpiredSubscriptionContext($organizationId: ID!, $now: String!) {
    lastExpiredContext: allSubscriptionContexts(
        where: {
            organization: { id: $organizationId }
            endAt_lt: $now
            deletedAt: null
        }
        sortBy: [endAt_DESC]
        first: 1
    ) {
        id
        subscriptionPlan {
            id
            name
        }
        isTrial
        startAt
        endAt
    }
}