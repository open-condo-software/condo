const { Ticket } = require('../utils/serverSchema')

/**
 * Generated by `createservice ticket.GetAllResidentTicketsService --type queries`
 */

const { GQLCustomSchema } = require('@core/keystone/schema')
const access = require('@condo/domains/ticket/access/GetAllResidentTicketsService')


const GetAllResidentTicketsService = new GQLCustomSchema('GetAllResidentTicketsService', {
    queries: [
        {
            access: access.canGetAllResidentTickets,
            schema: 'getAllResidentTickets: [Ticket]',
            resolver: async (parent, args, context, info, extra = {}) => {
                const clientId = context.req.user.id
                const tickets = (await Ticket.getAll(context, { createdBy: { id: clientId } }))

                console.log(tickets)

                return tickets
            },
        },
    ],
    
})

module.exports = {
    GetAllResidentTicketsService,
}
