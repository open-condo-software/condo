/**
 * Generated by `createservice ticket.GetAllResidentTicketsService --type queries`
 */
const { Ticket } = require('../utils/serverSchema')
const { GQLCustomSchema } = require('@core/keystone/schema')
const access = require('@condo/domains/ticket/access/GetAllResidentTicketsService')

const GetAllResidentTicketsService = new GQLCustomSchema('GetAllResidentTicketsService', {
    queries: [
        {
            access: access.canGetAllResidentTickets,
            schema: 'getAllResidentTickets (where: TicketWhereInput, first: Int!, skip: Int!): [ResidentTicketOutput]',
            resolver: async (parent, args, context, info, extra = {}) => {
                const { where, first, skip } = args
                const clientId = context.req.user.id
                return await Ticket.getAll(context, { ...where, client: { id: clientId } }, {
                    first,
                    skip,
                })
            },
        },
    ],
})

module.exports = {
    GetAllResidentTicketsService,
}