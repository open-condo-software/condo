/**
 * Generated by `createservice ticket.ResidentTicketService --type mutations`
 */

const { createTestTicket } = require('../utils/testSchema')
const { makeClientWithProperty } = require('../../property/utils/testSchema')
const { makeLoggedInAdminClient, makeClient } = require('@core/keystone/test.utils')
const { expectToThrowAccessDeniedErrorToObj } = require('@condo/domains/common/utils/testSchema')

const { createResidentTicketByTestClient } = require('@condo/domains/ticket/utils/testSchema')

const TICKET_OPEN_STATUS_ID = '6ef3abc4-022f-481b-90fb-8430345ebfc2'
const TICKET_UNKNOWN_CLASSIFIER_ID = '4f4b43d5-0951-425c-9428-945dc6193361'
const TICKET_OTHER_SOURCE_ID = '7da1e3be-06ba-4c9e-bba6-f97f278ac6e4'

describe('ResidentTicketService', () => {
    // test('user: execute', async () => {
    //     const client = await makeClient()  // TODO(codegen): use truly useful client!
    //     const payload = {}  // TODO(codegen): change the 'user: update ResidentTicketService' payload
    //     const [data, attrs] = await residentTicketByTestClient(client, payload)
    //     // TODO(codegen): write user expect logic
    //     throw new Error('Not implemented yet')
    // })
    //
    // test('anonymous: execute', async () => {
    //     const client = await makeClient()
    //     await expectToThrowAccessDeniedErrorToObj(async () => {
    //         await residentTicketByTestClient(client)
    //     })
    // })

    test('admin: execute', async () => {
        const admin = await makeLoggedInAdminClient()
        const client = await makeClientWithProperty()
        const payload = {
            organizationId: client.organization.id,
            details: 'asdasdqwdakkdskkdkdkkskskaklkaskldalksdlkakldlkasld',
            classifierId: TICKET_UNKNOWN_CLASSIFIER_ID,
            propertyId: client.property.id,
            unitName: '2',
            sourceId: TICKET_OTHER_SOURCE_ID,
        }

        // const [ticket] = await createTestTicket(client, client.organization, client.property, { status: null })
        const [data, attrs] = await createResidentTicketByTestClient(admin, payload)
        console.log(data)
        // TODO(codegen): write admin expect logic
        // throw new Error('Not implemented yet')
    })
})
