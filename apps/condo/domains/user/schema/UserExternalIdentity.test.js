/**
 * Generated by `createschema user.UserExternalIdentity`
 */

const {
    makeLoggedInAdminClient,
} = require('@open-condo/keystone/test.utils')

const {
    UserExternalIdentity,
    createTestUserExternalIdentity,
    makeClientWithResidentUser,
    makeClientWithStaffUser,
    makeClientWithServiceUser,
} = require('@condo/domains/user/utils/testSchema')
const { expectToThrowAccessDeniedErrorToObj } = require('@open-condo/keystone/test.utils')

describe('UserExternalIdentity create', () => {
    test('Denied: RESIDENT', async () => {
        const client = await makeClientWithResidentUser()

        await expectToThrowAccessDeniedErrorToObj(async () => {
            await createTestUserExternalIdentity(client)
        })
    })

    test('Denied: STAFF', async () => {
        const client = await makeClientWithStaffUser()

        await expectToThrowAccessDeniedErrorToObj(async () => {
            await createTestUserExternalIdentity(client)
        })
    })

    test('Denied: SERVICE', async () => {
        const client = await makeClientWithServiceUser()

        await expectToThrowAccessDeniedErrorToObj(async () => {
            await createTestUserExternalIdentity(client)
        })
    })

    test('Denied: admin', async () => {
        const admin = await makeLoggedInAdminClient()

        await expectToThrowAccessDeniedErrorToObj(async () => {
            await createTestUserExternalIdentity(admin)
        })
    })
})

// todo add update/read/delete tests