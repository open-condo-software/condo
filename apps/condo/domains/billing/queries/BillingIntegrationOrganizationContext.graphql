query getBillingIntegrationOrganizationContexts ($integration: BillingIntegrationWhereInput!, $organization: OrganizationWhereInput!) {
    contexts: allBillingIntegrationOrganizationContexts(
        where: {
            integration: $integration,
            organization: $organization,
        },
        first: 1,
    ) {
        id
        lastReport
    }
}

query getBillingIntegrationOrganizationContextsWithLastReport ($organization: OrganizationWhereInput!) {
    contexts: allBillingIntegrationOrganizationContexts(
        where: {
            organization: $organization,
            lastReport_not: null,
        },
        first: 1,
    ) {
        id
        lastReport
    }
}


query hasBillingIntegrations ($organization: OrganizationWhereInput!) {
    integrations: allBillingIntegrationOrganizationContexts(
        where: { organization: $organization, status: "Finished" }
        first: 1
        skip: 0
    ) {
        id
    }
    acquiring: allAcquiringIntegrationContexts (
        where: { organization: $organization, status: "Finished" }
        first: 1
        skip: 0
    ) {
        id
    }
}

query getBillingIntegrationOrganizationContextsByOrg ($organization: OrganizationWhereInput!) {
    contexts: allBillingIntegrationOrganizationContexts(
        where: {
            organization: $organization,
        },
        first: 100,
        sortBy: [createdAt_DESC]
    ) {
        id
        lastReport
        integration {
            id
        }
    }
}

mutation createBillingIntegrationOrganizationContext ($data: BillingIntegrationOrganizationContextCreateInput!) {
    billingContext: createBillingIntegrationOrganizationContext (data: $data) {
        id
    }
}


mutation softDeleteBillingContext ($id: ID!, $deletedAt: String!, $sender: SenderFieldInput!) {
    billingContext: updateBillingIntegrationOrganizationContext (id: $id, data: { deletedAt: $deletedAt, dv: 1, sender: $sender }) {
        id
    }
}