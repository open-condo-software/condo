/**
 * Generated by `createschema acquiring.AcquiringIntegration 'name:Text;'`
 * In most cases you should not change it by hands
 * Please, don't remove `AUTOGENERATE MARKER`s
 */

const { gql } = require('graphql-tag')

const { generateGqlQueries } = require('@open-condo/codegen/generate.gql')

const { ADDRESS_META_SUBFIELDS_QUERY_LIST } = require('@condo/domains/property/schema/fields/AddressMetaField')

const COMMON_FIELDS = 'id dv sender { dv fingerprint } v deletedAt newId createdBy { id name } updatedBy { id name } createdAt updatedAt'

const ACQUIRING_INTEGRATION_FIELDS = `{ name minimumPaymentAmount maximumPaymentAmount setupUrl canGroupReceipts hostUrl supportedBillingIntegrationsGroup vatPercentOptions ${COMMON_FIELDS} }`
const AcquiringIntegration = generateGqlQueries('AcquiringIntegration', ACQUIRING_INTEGRATION_FIELDS)

const ACQUIRING_INTEGRATION_ACCESS_RIGHT_FIELDS = `{ user { id } integration { id } ${COMMON_FIELDS} }`
const AcquiringIntegrationAccessRight = generateGqlQueries('AcquiringIntegrationAccessRight', ACQUIRING_INTEGRATION_ACCESS_RIGHT_FIELDS)

const FEE_DISTRIBUTION_FIELDS = 'recipient percent minAmount maxAmount category'

const ACQUIRING_INTEGRATION_CONTEXT_FIELDS = `{ status invoiceStatus integration { id name setupUrl hostUrl explicitFeeDistributionSchema { ${FEE_DISTRIBUTION_FIELDS} } } organization { id } state settings ${COMMON_FIELDS} implicitFeeDistributionSchema { ${FEE_DISTRIBUTION_FIELDS} } invoiceImplicitFeeDistributionSchema { ${FEE_DISTRIBUTION_FIELDS} } email invoiceEmails reason invoiceReason recipient { bic bankAccount iec tin } invoiceRecipient { bic bankAccount iec tin } invoiceTaxRegime invoiceVatPercent invoiceSalesTaxPercent }`
const AcquiringIntegrationContext = generateGqlQueries('AcquiringIntegrationContext', ACQUIRING_INTEGRATION_CONTEXT_FIELDS)

const MULTI_PAYMENT_PAYER_INFO_FIELDS = 'payerInfo { id name email phone }'
const MULTI_PAYMENT_COMMON_FIELDS = `amount explicitFee explicitServiceCharge implicitFee amountWithoutExplicitFee currencyCode withdrawnAt cardNumber paymentWay serviceCategory payerEmail transactionId meta status payments { id } integration { id } recurrentPaymentContext { id } ${COMMON_FIELDS}`
const MULTI_PAYMENT_FIELDS = `{ ${MULTI_PAYMENT_COMMON_FIELDS} }`
const MULTI_PAYMENT_WITH_PAYER_INFO = `{ ${MULTI_PAYMENT_PAYER_INFO_FIELDS} ${MULTI_PAYMENT_COMMON_FIELDS} }`
const MULTI_PAYMENT_ADMIN_FIELDS = `{ user { id name email phone isEmailVerified isPhoneVerified } ${MULTI_PAYMENT_PAYER_INFO_FIELDS} ${MULTI_PAYMENT_COMMON_FIELDS} }`
const MultiPayment = generateGqlQueries('MultiPayment', MULTI_PAYMENT_FIELDS)
const MultiPaymentWithPayerInfo = generateGqlQueries('MultiPayment', MULTI_PAYMENT_WITH_PAYER_INFO)
const MultiPaymentAdmin = generateGqlQueries('MultiPayment', MULTI_PAYMENT_ADMIN_FIELDS)

const PAYMENT_FIELDS = `{ amount explicitFee explicitServiceCharge implicitFee currencyCode advancedAt depositedDate transferDate accountNumber purpose frozenReceipt receipt { id property { id address addressKey } account { unitName } } invoice { id organization { id name } status property { id address addressKey } number ticket { id number } } frozenInvoice multiPayment { id transactionId } context { id integration { id name } } status order ${COMMON_FIELDS} period organization { id } recipientBic recipientBankAccount rawAddress frozenDistribution frozenSplits posReceiptUrl }`
const Payment = generateGqlQueries('Payment', PAYMENT_FIELDS)

const REGISTER_MULTI_PAYMENT_MUTATION = gql`
    mutation registerMultiPayment ($data: RegisterMultiPaymentInput!) {
        result: registerMultiPayment(data: $data) { dv multiPaymentId webViewUrl feeCalculationUrl directPaymentUrl getCardTokensUrl }
    }
`

const PAYMENTS_FILTER_FIELDS = '{ advancedAt depositedDate transferDate accountNumber address type order status }'
const PAYMENTS_FILTER_TEMPLATE_FIELDS = `{ name employee { id } fields ${PAYMENTS_FILTER_FIELDS} ${COMMON_FIELDS} }`
const PaymentsFilterTemplate = generateGqlQueries('PaymentsFilterTemplate', PAYMENTS_FILTER_TEMPLATE_FIELDS)

const REGISTER_MULTI_PAYMENT_FOR_ONE_RECEIPT_MUTATION = gql`
    mutation registerMultiPaymentForOneReceipt ($data: RegisterMultiPaymentForOneReceiptInput!) {
        result: registerMultiPaymentForOneReceipt(data: $data) { dv multiPaymentId webViewUrl feeCalculationUrl directPaymentUrl anonymousPaymentUrl }
    }
`

const REGISTER_MULTI_PAYMENT_FOR_VIRTUAL_RECEIPT_MUTATION = gql`
    mutation registerMultiPaymentForVirtualReceipt ($data: RegisterMultiPaymentForVirtualReceiptInput!) {
        result: registerMultiPaymentForVirtualReceipt(data: $data) { dv multiPaymentId webViewUrl feeCalculationUrl directPaymentUrl anonymousPaymentUrl }
    }
`

const GENERATE_PAYMENT_LINK_QUERY = gql`
    query generatePaymentLink ($data: GeneratePaymentLinkInput!) {
        result: generatePaymentLink(data: $data) { dv, paymentUrl }
    }
`


const SUM_PAYMENTS_QUERY = gql`
    query _allPaymentsSum ($data: PaymentsSumInput!) {
        result: _allPaymentsSum(data: $data) { sum }
    }
`

const RECURRENT_PAYMENT_CONTEXT_FIELDS = `{ enabled limit autoPayReceipts paymentDay settings { cardId } serviceConsumer { id resident { id user { id } } } billingCategory { id } ${COMMON_FIELDS} }`
const RecurrentPaymentContext = generateGqlQueries('RecurrentPaymentContext', RECURRENT_PAYMENT_CONTEXT_FIELDS)

const RECURRENT_PAYMENT_FIELDS = `{ status tryCount state payAfter billingReceipts { id } recurrentPaymentContext { id } ${COMMON_FIELDS} }`
const RecurrentPayment = generateGqlQueries('RecurrentPayment', RECURRENT_PAYMENT_FIELDS)

const PAYMENT_BY_LINK_MUTATION = gql`
    mutation createPaymentByLink ($data: CreatePaymentByLinkInput!) {
        result: createPaymentByLink(data: $data) { multiPaymentId amount explicitFee totalAmount acquiringIntegrationHostUrl currencyCode address addressMeta { ${ADDRESS_META_SUBFIELDS_QUERY_LIST} } unitType unitName accountNumber period }
    }
`

const REGISTER_MULTI_PAYMENT_FOR_INVOICES_MUTATION = gql`
    mutation registerMultiPaymentForInvoices ($data: RegisterMultiPaymentForInvoicesInput!) {
        result: registerMultiPaymentForInvoices(data: $data) { dv multiPaymentId webViewUrl feeCalculationUrl directPaymentUrl anonymousPaymentUrl }
    }
`

const CALCULATE_FEE_FOR_RECEIPT_QUERY = gql`
    query calculateFeeForReceipt ($data: CalculateFeeForReceiptInput!) {
        result: calculateFeeForReceipt(data: $data) { amountWithoutExplicitFee explicitFee explicitServiceCharge }
    }
`

const PAYMENTS_FILE_FIELDS = `{ number file { id originalFilename publicUrl mimetype } context { id } importId bankAccount paymentPeriodStartDate paymentPeriodEndDay loadedAt paymentsCount amount amountWithoutFees name status bankComment paymentOrder ${COMMON_FIELDS} }`
const PaymentsFile = generateGqlQueries('PaymentsFile', PAYMENTS_FILE_FIELDS)

const SET_PAYMENT_POS_RECEIPT_URL_MUTATION = gql`
    mutation setPaymentPosReceiptUrl ($data: SetPaymentPosReceiptUrlInput!) {
        result: setPaymentPosReceiptUrl(data: $data) { success }
    }
`

const PAYMENT_STATUS_CHANGE_WEBHOOK_URL_FIELDS = `{ name url isEnabled description organization { id name } ${COMMON_FIELDS} }`
const PaymentStatusChangeWebhookUrl = generateGqlQueries('PaymentStatusChangeWebhookUrl', PAYMENT_STATUS_CHANGE_WEBHOOK_URL_FIELDS)

/* AUTOGENERATE MARKER <CONST> */

const EXPORT_PAYMENTS_TO_EXCEL =  gql`
    query exportPaymentsToExcel ($data: ExportPaymentsToExcelInput!) {
        result: exportPaymentsToExcel(data: $data) { status, linkToFile }
    }
`

module.exports = {
    AcquiringIntegration,
    AcquiringIntegrationAccessRight,
    AcquiringIntegrationContext,
    MultiPayment,
    MultiPaymentWithPayerInfo,
    MultiPaymentAdmin,
    Payment,
    REGISTER_MULTI_PAYMENT_MUTATION,
    EXPORT_PAYMENTS_TO_EXCEL,
    PaymentsFilterTemplate,
    REGISTER_MULTI_PAYMENT_FOR_ONE_RECEIPT_MUTATION,
    REGISTER_MULTI_PAYMENT_FOR_VIRTUAL_RECEIPT_MUTATION,
    GENERATE_PAYMENT_LINK_QUERY,
    SUM_PAYMENTS_QUERY,
    RecurrentPaymentContext,
    RecurrentPayment,
    PAYMENT_BY_LINK_MUTATION,
    REGISTER_MULTI_PAYMENT_FOR_INVOICES_MUTATION,
    CALCULATE_FEE_FOR_RECEIPT_QUERY,
    PaymentsFile,
    SET_PAYMENT_POS_RECEIPT_URL_MUTATION,
    PAYMENT_STATUS_CHANGE_WEBHOOK_URL_FIELDS,
    PaymentStatusChangeWebhookUrl,
/* AUTOGENERATE MARKER <EXPORTS> */
}
