// auto generated by kmigrator
// KMIGRATOR:0131_remove_ticketchange_watchersdisplaynamesfrom_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMC40IG9uIDIwMjItMDUtMTggMDY6MTgKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwMTMwX2NvbnRhY3RfdW5pdHR5cGVfY29udGFjdGhpc3RvcnlyZWNvcmRfdW5pdHR5cGUnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGNoYW5nZScsCiAgICAgICAgICAgIG5hbWU9J3dhdGNoZXJzRGlzcGxheU5hbWVzRnJvbScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSd3YXRjaGVyc0Rpc3BsYXlOYW1lc1RvJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGNoYW5nZScsCiAgICAgICAgICAgIG5hbWU9J3dhdGNoZXJzSWRzRnJvbScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSd3YXRjaGVyc0lkc1RvJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuRGVsZXRlTW9kZWwoCiAgICAgICAgICAgIG5hbWU9J3RpY2tldF93YXRjaGVyc19tYW55JywKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove field watchersDisplayNamesFrom from ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "watchersDisplayNamesFrom" CASCADE;
--
-- Remove field watchersDisplayNamesTo from ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "watchersDisplayNamesTo" CASCADE;
--
-- Remove field watchersIdsFrom from ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "watchersIdsFrom" CASCADE;
--
-- Remove field watchersIdsTo from ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "watchersIdsTo" CASCADE;
--
-- Delete model ticket_watchers_many
--
DROP TABLE "Ticket_watchers_many" CASCADE;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model ticket_watchers_many
--
CREATE TABLE "Ticket_watchers_many" ("id" serial NOT NULL PRIMARY KEY, "Ticket_left_id" uuid NOT NULL, "User_right_id" uuid NOT NULL);
--
-- Remove field watchersIdsTo from ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "watchersIdsTo" jsonb NOT NULL;
--
-- Remove field watchersIdsFrom from ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "watchersIdsFrom" jsonb NOT NULL;
--
-- Remove field watchersDisplayNamesTo from ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "watchersDisplayNamesTo" jsonb NOT NULL;
--
-- Remove field watchersDisplayNamesFrom from ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "watchersDisplayNamesFrom" jsonb NOT NULL;
ALTER TABLE "Ticket_watchers_many" ADD CONSTRAINT "Ticket_watchers_many_Ticket_left_id_bc32608f_fk_Ticket_id" FOREIGN KEY ("Ticket_left_id") REFERENCES "Ticket" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Ticket_watchers_many" ADD CONSTRAINT "Ticket_watchers_many_User_right_id_ad215bb2_fk_User_id" FOREIGN KEY ("User_right_id") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Ticket_watchers_many_Ticket_left_id_bc32608f" ON "Ticket_watchers_many" ("Ticket_left_id");
CREATE INDEX "Ticket_watchers_many_User_right_id_ad215bb2" ON "Ticket_watchers_many" ("User_right_id");
COMMIT;

    `)
}
