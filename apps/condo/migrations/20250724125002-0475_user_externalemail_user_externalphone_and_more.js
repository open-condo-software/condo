// auto generated by kmigrator
// KMIGRATOR:0475_user_externalemail_user_externalphone_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDUuMSBvbiAyMDI1LTA3LTI0IDA3OjUwCgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucywgbW9kZWxzCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwNDc0X2JpbGxpbmdpbnRlZ3JhdGlvbl9iaWxsaW5ncGFnZWljb25fYW5kX21vcmUnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXInLAogICAgICAgICAgICBuYW1lPSdleHRlcm5hbEVtYWlsJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcicsCiAgICAgICAgICAgIG5hbWU9J2V4dGVybmFsUGhvbmUnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyJywKICAgICAgICAgICAgbmFtZT0nZXh0ZXJuYWxTeXN0ZW1OYW1lJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcicsCiAgICAgICAgICAgIG5hbWU9J2lzRXh0ZXJuYWxFbWFpbFZlcmlmaWVkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkJvb2xlYW5GaWVsZChkZWZhdWx0PUZhbHNlKSwKICAgICAgICAgICAgcHJlc2VydmVfZGVmYXVsdD1GYWxzZSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXInLAogICAgICAgICAgICBuYW1lPSdpc0V4dGVybmFsUGhvbmVWZXJpZmllZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Cb29sZWFuRmllbGQoZGVmYXVsdD1GYWxzZSksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2V4dGVybmFsRW1haWwnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2V4dGVybmFsUGhvbmUnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2V4dGVybmFsU3lzdGVtTmFtZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXJoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naXNFeHRlcm5hbEVtYWlsVmVyaWZpZWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuQm9vbGVhbkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2lzRXh0ZXJuYWxQaG9uZVZlcmlmaWVkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkJvb2xlYW5GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyZXh0ZXJuYWxpZGVudGl0eScsCiAgICAgICAgICAgIG5hbWU9J2lkZW50aXR5VHlwZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoKSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field externalEmail to user
--
ALTER TABLE "User" ADD COLUMN "externalEmail" text NULL;
--
-- Add field externalPhone to user
--
ALTER TABLE "User" ADD COLUMN "externalPhone" text NULL;
--
-- Add field externalSystemName to user
--
ALTER TABLE "User" ADD COLUMN "externalSystemName" text NULL;
--
-- Add field isExternalEmailVerified to user
--
ALTER TABLE "User" ADD COLUMN "isExternalEmailVerified" boolean DEFAULT false NOT NULL;
ALTER TABLE "User" ALTER COLUMN "isExternalEmailVerified" DROP DEFAULT;
--
-- Add field isExternalPhoneVerified to user
--
ALTER TABLE "User" ADD COLUMN "isExternalPhoneVerified" boolean DEFAULT false NOT NULL;
ALTER TABLE "User" ALTER COLUMN "isExternalPhoneVerified" DROP DEFAULT;
--
-- Add field externalEmail to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "externalEmail" text NULL;
--
-- Add field externalPhone to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "externalPhone" text NULL;
--
-- Add field externalSystemName to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "externalSystemName" text NULL;
--
-- Add field isExternalEmailVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "isExternalEmailVerified" boolean NULL;
--
-- Add field isExternalPhoneVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "isExternalPhoneVerified" boolean NULL;
--
-- Alter field identityType on userexternalidentity
--
ALTER TABLE "UserExternalIdentity" ALTER COLUMN "identityType" TYPE text USING "identityType"::text;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field identityType on userexternalidentity
--
ALTER TABLE "UserExternalIdentity" ALTER COLUMN "identityType" TYPE varchar(50) USING "identityType"::varchar(50);
--
-- Add field isExternalPhoneVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "isExternalPhoneVerified" CASCADE;
--
-- Add field isExternalEmailVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "isExternalEmailVerified" CASCADE;
--
-- Add field externalSystemName to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "externalSystemName" CASCADE;
--
-- Add field externalPhone to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "externalPhone" CASCADE;
--
-- Add field externalEmail to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "externalEmail" CASCADE;
--
-- Add field isExternalPhoneVerified to user
--
ALTER TABLE "User" DROP COLUMN "isExternalPhoneVerified" CASCADE;
--
-- Add field isExternalEmailVerified to user
--
ALTER TABLE "User" DROP COLUMN "isExternalEmailVerified" CASCADE;
--
-- Add field externalSystemName to user
--
ALTER TABLE "User" DROP COLUMN "externalSystemName" CASCADE;
--
-- Add field externalPhone to user
--
ALTER TABLE "User" DROP COLUMN "externalPhone" CASCADE;
--
-- Add field externalEmail to user
--
ALTER TABLE "User" DROP COLUMN "externalEmail" CASCADE;
COMMIT;

    `)
}
