// auto generated by kmigrator
// KMIGRATOR:0076_auto_20211030_1309:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi44IG9uIDIwMjEtMTAtMzAgMTM6MDkKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwNzVfcmVzaWRlbnRoaXN0b3J5cmVjb3JkX3BheW1lbnRjYXRlZ29yaWVzJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdwYXltZW50JywKICAgICAgICAgICAgbmFtZT0nb3JnYW5pemF0aW9uJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoZGJfY29sdW1uPSdvcmdhbml6YXRpb24nLCBkZWZhdWx0PTEsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLlBST1RFQ1QsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS5vcmdhbml6YXRpb24nKSwKICAgICAgICAgICAgcHJlc2VydmVfZGVmYXVsdD1GYWxzZSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3BheW1lbnQnLAogICAgICAgICAgICBuYW1lPSdwZXJpb2QnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRGF0ZUZpZWxkKGRlZmF1bHQ9JzIwMjEtMTAtMDEnKSwKICAgICAgICAgICAgcHJlc2VydmVfZGVmYXVsdD1GYWxzZSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3BheW1lbnRoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nb3JnYW5pemF0aW9uJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlVVSURGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ncGF5bWVudGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdwZXJpb2QnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRGF0ZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3BheW1lbnQnLAogICAgICAgICAgICBuYW1lPSdjb250ZXh0JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoYmxhbms9VHJ1ZSwgZGJfY29sdW1uPSdjb250ZXh0Jywgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uUFJPVEVDVCwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLmFjcXVpcmluZ2ludGVncmF0aW9uY29udGV4dCcpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdwYXltZW50JywKICAgICAgICAgICAgbmFtZT0ncmVjZWlwdCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0ncmVjZWlwdCcsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLlBST1RFQ1QsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS5iaWxsaW5ncmVjZWlwdCcpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field organization to payment
--
ALTER TABLE "Payment" ADD COLUMN "organization" uuid DEFAULT '00000000-0000-0000-0000-000000000001'::uuid NOT NULL CONSTRAINT "Payment_organization_64e36db3_fk_Organization_id" REFERENCES "Organization"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Payment_organization_64e36db3_fk_Organization_id" IMMEDIATE;
ALTER TABLE "Payment" ALTER COLUMN "organization" DROP DEFAULT;
--
-- Add field period to payment
--
ALTER TABLE "Payment" ADD COLUMN "period" date DEFAULT '2021-10-01'::date NOT NULL;
ALTER TABLE "Payment" ALTER COLUMN "period" DROP DEFAULT;
--
-- Add field organization to paymenthistoryrecord
--
ALTER TABLE "PaymentHistoryRecord" ADD COLUMN "organization" uuid NULL;
--
-- Add field period to paymenthistoryrecord
--
ALTER TABLE "PaymentHistoryRecord" ADD COLUMN "period" date NULL;
--
-- Alter field context on payment
--
--
-- Alter field receipt on payment
--
CREATE INDEX "Payment_organization_64e36db3" ON "Payment" ("organization");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field receipt on payment
--
--
-- Alter field context on payment
--
--
-- Add field period to paymenthistoryrecord
--
ALTER TABLE "PaymentHistoryRecord" DROP COLUMN "period" CASCADE;
--
-- Add field organization to paymenthistoryrecord
--
ALTER TABLE "PaymentHistoryRecord" DROP COLUMN "organization" CASCADE;
--
-- Add field period to payment
--
ALTER TABLE "Payment" DROP COLUMN "period" CASCADE;
--
-- Add field organization to payment
--
ALTER TABLE "Payment" DROP COLUMN "organization" CASCADE;
COMMIT;

    `)
}
