// auto generated by kmigrator
// KMIGRATOR:0496_ticket_senttoauthoritiesat_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMC41IG9uIDIwMjUtMTItMDIgMTA6MjcKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzA0OTVfdXNlcl9pc3R3b2ZhY3RvcmF1dGhlbnRpY2F0aW9uZW5hYmxlZF9hbmRfbW9yZScpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0JywKICAgICAgICAgICAgbmFtZT0nc2VudFRvQXV0aG9yaXRpZXNBdCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSdzZW50VG9BdXRob3JpdGllc0F0RnJvbScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSdzZW50VG9BdXRob3JpdGllc0F0VG8nLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRGF0ZVRpbWVGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3NlbnRUb0F1dGhvcml0aWVzQXQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRGF0ZVRpbWVGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcnJpZ2h0c3NldCcsCiAgICAgICAgICAgIG5hbWU9J2Nhbk1hbmFnZVRpY2tldFNlbnRUb0F1dGhvcml0aWVzQXRGaWVsZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Cb29sZWFuRmllbGQoZGVmYXVsdD1GYWxzZSksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VycmlnaHRzc2V0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2Nhbk1hbmFnZVRpY2tldFNlbnRUb0F1dGhvcml0aWVzQXRGaWVsZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Cb29sZWFuRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field sentToAuthoritiesAt to ticket
--
ALTER TABLE "Ticket" ADD COLUMN "sentToAuthoritiesAt" timestamp with time zone NULL;
--
-- Add field sentToAuthoritiesAtFrom to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "sentToAuthoritiesAtFrom" timestamp with time zone NULL;
--
-- Add field sentToAuthoritiesAtTo to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "sentToAuthoritiesAtTo" timestamp with time zone NULL;
--
-- Add field sentToAuthoritiesAt to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" ADD COLUMN "sentToAuthoritiesAt" timestamp with time zone NULL;
--
-- Add field canManageTicketSentToAuthoritiesAtField to userrightsset
--
ALTER TABLE "UserRightsSet" ADD COLUMN "canManageTicketSentToAuthoritiesAtField" boolean DEFAULT false NOT NULL;
ALTER TABLE "UserRightsSet" ALTER COLUMN "canManageTicketSentToAuthoritiesAtField" DROP DEFAULT;
--
-- Add field canManageTicketSentToAuthoritiesAtField to userrightssethistoryrecord
--
ALTER TABLE "UserRightsSetHistoryRecord" ADD COLUMN "canManageTicketSentToAuthoritiesAtField" boolean NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field canManageTicketSentToAuthoritiesAtField to userrightssethistoryrecord
--
ALTER TABLE "UserRightsSetHistoryRecord" DROP COLUMN "canManageTicketSentToAuthoritiesAtField" CASCADE;
--
-- Add field canManageTicketSentToAuthoritiesAtField to userrightsset
--
ALTER TABLE "UserRightsSet" DROP COLUMN "canManageTicketSentToAuthoritiesAtField" CASCADE;
--
-- Add field sentToAuthoritiesAt to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" DROP COLUMN "sentToAuthoritiesAt" CASCADE;
--
-- Add field sentToAuthoritiesAtTo to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "sentToAuthoritiesAtTo" CASCADE;
--
-- Add field sentToAuthoritiesAtFrom to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "sentToAuthoritiesAtFrom" CASCADE;
--
-- Add field sentToAuthoritiesAt to ticket
--
ALTER TABLE "Ticket" DROP COLUMN "sentToAuthoritiesAt" CASCADE;
COMMIT;

    `)
}
