// auto generated by kmigrator
// KMIGRATOR:0154_meter_b2bapp_meter_b2capp_meterhistoryrecord_b2bapp_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMC4yIG9uIDIwMjItMDctMjUgMTA6NTEKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAxNTNfcmVtb3ZlX3RpY2tldF9wbGFjZWNsYXNzaWZpZXJfYW5kX21vcmUnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J21ldGVyJywKICAgICAgICAgICAgbmFtZT0nYjJiQXBwJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoYmxhbms9VHJ1ZSwgZGJfY29sdW1uPSdiMmJBcHAnLCBudWxsPVRydWUsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLlNFVF9OVUxMLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEuYjJiYXBwJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdtZXRlcicsCiAgICAgICAgICAgIG5hbWU9J2IyY0FwcCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0nYjJjQXBwJywgbnVsbD1UcnVlLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5TRVRfTlVMTCwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLmIyY2FwcCcpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbWV0ZXJoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nYjJiQXBwJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlVVSURGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbWV0ZXJoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nYjJjQXBwJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlVVSURGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field b2bApp to meter
--
ALTER TABLE "Meter" ADD COLUMN "b2bApp" uuid NULL CONSTRAINT "Meter_b2bApp_3101a0e5_fk_B2BApp_id" REFERENCES "B2BApp"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Meter_b2bApp_3101a0e5_fk_B2BApp_id" IMMEDIATE;
--
-- Add field b2cApp to meter
--
ALTER TABLE "Meter" ADD COLUMN "b2cApp" uuid NULL CONSTRAINT "Meter_b2cApp_4fbac346_fk_B2CApp_id" REFERENCES "B2CApp"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Meter_b2cApp_4fbac346_fk_B2CApp_id" IMMEDIATE;
--
-- Add field b2bApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" ADD COLUMN "b2bApp" uuid NULL;
--
-- Add field b2cApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" ADD COLUMN "b2cApp" uuid NULL;
CREATE INDEX "Meter_b2bApp_3101a0e5" ON "Meter" ("b2bApp");
CREATE INDEX "Meter_b2cApp_4fbac346" ON "Meter" ("b2cApp");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field b2cApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" DROP COLUMN "b2cApp" CASCADE;
--
-- Add field b2bApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" DROP COLUMN "b2bApp" CASCADE;
--
-- Add field b2cApp to meter
--
ALTER TABLE "Meter" DROP COLUMN "b2cApp" CASCADE;
--
-- Add field b2bApp to meter
--
ALTER TABLE "Meter" DROP COLUMN "b2bApp" CASCADE;
COMMIT;

    `)
}
