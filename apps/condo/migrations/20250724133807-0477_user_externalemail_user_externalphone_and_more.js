// auto generated by kmigrator
// KMIGRATOR:0477_user_externalemail_user_externalphone_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDUuMSBvbiAyMDI1LTA3LTI0IDA4OjM4Cgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucywgbW9kZWxzCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwNDc2X2V4ZWN1dGlvbmFpZmxvd3Rhc2tfY2xlYW5jb250ZXh0X2FuZF9tb3JlJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyJywKICAgICAgICAgICAgbmFtZT0nZXh0ZXJuYWxFbWFpbCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXInLAogICAgICAgICAgICBuYW1lPSdleHRlcm5hbFBob25lJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcicsCiAgICAgICAgICAgIG5hbWU9J2V4dGVybmFsU3lzdGVtTmFtZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXInLAogICAgICAgICAgICBuYW1lPSdpc0V4dGVybmFsRW1haWxWZXJpZmllZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Cb29sZWFuRmllbGQoZGVmYXVsdD1GYWxzZSksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyJywKICAgICAgICAgICAgbmFtZT0naXNFeHRlcm5hbFBob25lVmVyaWZpZWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuQm9vbGVhbkZpZWxkKGRlZmF1bHQ9RmFsc2UpLAogICAgICAgICAgICBwcmVzZXJ2ZV9kZWZhdWx0PUZhbHNlLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdleHRlcm5hbEVtYWlsJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdleHRlcm5hbFBob25lJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdleHRlcm5hbFN5c3RlbU5hbWUnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2lzRXh0ZXJuYWxFbWFpbFZlcmlmaWVkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkJvb2xlYW5GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdpc0V4dGVybmFsUGhvbmVWZXJpZmllZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Cb29sZWFuRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcmV4dGVybmFsaWRlbnRpdHknLAogICAgICAgICAgICBuYW1lPSdpZGVudGl0eVR5cGUnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKCksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field externalEmail to user
--
ALTER TABLE "User" ADD COLUMN "externalEmail" text NULL;
--
-- Add field externalPhone to user
--
ALTER TABLE "User" ADD COLUMN "externalPhone" text NULL;
--
-- Add field externalSystemName to user
--
ALTER TABLE "User" ADD COLUMN "externalSystemName" text NULL;
--
-- Add field isExternalEmailVerified to user
--
ALTER TABLE "User" ADD COLUMN "isExternalEmailVerified" boolean DEFAULT false NOT NULL;
ALTER TABLE "User" ALTER COLUMN "isExternalEmailVerified" DROP DEFAULT;
--
-- Add field isExternalPhoneVerified to user
--
ALTER TABLE "User" ADD COLUMN "isExternalPhoneVerified" boolean DEFAULT false NOT NULL;
ALTER TABLE "User" ALTER COLUMN "isExternalPhoneVerified" DROP DEFAULT;
--
-- Add field externalEmail to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "externalEmail" text NULL;
--
-- Add field externalPhone to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "externalPhone" text NULL;
--
-- Add field externalSystemName to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "externalSystemName" text NULL;
--
-- Add field isExternalEmailVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "isExternalEmailVerified" boolean NULL;
--
-- Add field isExternalPhoneVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "isExternalPhoneVerified" boolean NULL;
--
-- Alter field identityType on userexternalidentity
--
ALTER TABLE "UserExternalIdentity" ALTER COLUMN "identityType" TYPE text USING "identityType"::text;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field identityType on userexternalidentity
--
ALTER TABLE "UserExternalIdentity" ALTER COLUMN "identityType" TYPE varchar(50) USING "identityType"::varchar(50);
--
-- Add field isExternalPhoneVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "isExternalPhoneVerified" CASCADE;
--
-- Add field isExternalEmailVerified to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "isExternalEmailVerified" CASCADE;
--
-- Add field externalSystemName to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "externalSystemName" CASCADE;
--
-- Add field externalPhone to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "externalPhone" CASCADE;
--
-- Add field externalEmail to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "externalEmail" CASCADE;
--
-- Add field isExternalPhoneVerified to user
--
ALTER TABLE "User" DROP COLUMN "isExternalPhoneVerified" CASCADE;
--
-- Add field isExternalEmailVerified to user
--
ALTER TABLE "User" DROP COLUMN "isExternalEmailVerified" CASCADE;
--
-- Add field externalSystemName to user
--
ALTER TABLE "User" DROP COLUMN "externalSystemName" CASCADE;
--
-- Add field externalPhone to user
--
ALTER TABLE "User" DROP COLUMN "externalPhone" CASCADE;
--
-- Add field externalEmail to user
--
ALTER TABLE "User" DROP COLUMN "externalEmail" CASCADE;
COMMIT;

    `)
}
