// auto generated by kmigrator
// KMIGRATOR:0410_rename_lastpostrequest_newsitemsharing_lastpublishresponse_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMi4xIG9uIDIwMjQtMDctMTggMTQ6MTcKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzA0MDhfY29udGFjdF9xdW90YV9jb250YWN0aGlzdG9yeXJlY29yZF9xdW90YScpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5SZW5hbWVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbmV3c2l0ZW1zaGFyaW5nJywKICAgICAgICAgICAgb2xkX25hbWU9J2xhc3RQb3N0UmVxdWVzdCcsCiAgICAgICAgICAgIG5ld19uYW1lPSdsYXN0UHVibGlzaFJlc3BvbnNlJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVuYW1lRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J25ld3NpdGVtc2hhcmluZ2hpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBvbGRfbmFtZT0nbGFzdFBvc3RSZXF1ZXN0JywKICAgICAgICAgICAgbmV3X25hbWU9J2xhc3RQdWJsaXNoUmVzcG9uc2UnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYjJiYXBwbmV3c3NoYXJpbmdjb25maWcnLAogICAgICAgICAgICBuYW1lPSdjdXN0b21HZXRSZWNpcGllbnRzQ291bnRlcnNVcmwnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiMmJhcHBuZXdzc2hhcmluZ2NvbmZpZycsCiAgICAgICAgICAgIG5hbWU9J3B1c2hOb3RpZmljYXRpb25QcmV2aWV3U2V0dGluZ3MnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuQ2hhckZpZWxkKGNob2ljZXM9WygnT05MWV9FTUVSR0VOQ1knLCAnT05MWV9FTUVSR0VOQ1knKSwgKCdFTkFCTEVEJywgJ0VOQUJMRUQnKSwgKCdESVNBQkxFRCcsICdESVNBQkxFRCcpXSwgZGVmYXVsdD0nRElTQUJMRUQnLCBtYXhfbGVuZ3RoPTUwKSwKICAgICAgICAgICAgcHJlc2VydmVfZGVmYXVsdD1GYWxzZSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2IyYmFwcG5ld3NzaGFyaW5nY29uZmlnaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2N1c3RvbUdldFJlY2lwaWVudHNDb3VudGVyc1VybCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2IyYmFwcG5ld3NzaGFyaW5nY29uZmlnaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3B1c2hOb3RpZmljYXRpb25QcmV2aWV3U2V0dGluZ3MnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSduZXdzaXRlbXNoYXJpbmcnLAogICAgICAgICAgICBuYW1lPSdyZWNpcGllbnRzQ291bnQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSduZXdzaXRlbXNoYXJpbmdoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0ncmVjaXBpZW50c0NvdW50JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkpTT05GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiMmJhcHBuZXdzc2hhcmluZ2NvbmZpZycsCiAgICAgICAgICAgIG5hbWU9J2dldFJlY2lwaWVudHNVcmwnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Rename field lastPostRequest on newsitemsharing to lastPublishResponse
--
ALTER TABLE "NewsItemSharing" RENAME COLUMN "lastPostRequest" TO "lastPublishResponse";
--
-- Rename field lastPostRequest on newsitemsharinghistoryrecord to lastPublishResponse
--
ALTER TABLE "NewsItemSharingHistoryRecord" RENAME COLUMN "lastPostRequest" TO "lastPublishResponse";
--
-- Add field customGetRecipientsCountersUrl to b2bappnewssharingconfig
--
ALTER TABLE "B2BAppNewsSharingConfig" ADD COLUMN "customGetRecipientsCountersUrl" text NULL;
--
-- Add field pushNotificationPreviewSettings to b2bappnewssharingconfig
--
ALTER TABLE "B2BAppNewsSharingConfig" ADD COLUMN "pushNotificationPreviewSettings" varchar(50) DEFAULT 'DISABLED' NOT NULL;
ALTER TABLE "B2BAppNewsSharingConfig" ALTER COLUMN "pushNotificationPreviewSettings" DROP DEFAULT;
--
-- Add field customGetRecipientsCountersUrl to b2bappnewssharingconfighistoryrecord
--
ALTER TABLE "B2BAppNewsSharingConfigHistoryRecord" ADD COLUMN "customGetRecipientsCountersUrl" text NULL;
--
-- Add field pushNotificationPreviewSettings to b2bappnewssharingconfighistoryrecord
--
ALTER TABLE "B2BAppNewsSharingConfigHistoryRecord" ADD COLUMN "pushNotificationPreviewSettings" text NULL;
--
-- Add field recipientsCount to newsitemsharing
--
ALTER TABLE "NewsItemSharing" ADD COLUMN "recipientsCount" jsonb NULL;
--
-- Add field recipientsCount to newsitemsharinghistoryrecord
--
ALTER TABLE "NewsItemSharingHistoryRecord" ADD COLUMN "recipientsCount" jsonb NULL;
--
-- Alter field getRecipientsUrl on b2bappnewssharingconfig
--
ALTER TABLE "B2BAppNewsSharingConfig" ALTER COLUMN "getRecipientsUrl" DROP NOT NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field getRecipientsUrl on b2bappnewssharingconfig
--
ALTER TABLE "B2BAppNewsSharingConfig" ALTER COLUMN "getRecipientsUrl" SET NOT NULL;
--
-- Add field recipientsCount to newsitemsharinghistoryrecord
--
ALTER TABLE "NewsItemSharingHistoryRecord" DROP COLUMN "recipientsCount" CASCADE;
--
-- Add field recipientsCount to newsitemsharing
--
ALTER TABLE "NewsItemSharing" DROP COLUMN "recipientsCount" CASCADE;
--
-- Add field pushNotificationPreviewSettings to b2bappnewssharingconfighistoryrecord
--
ALTER TABLE "B2BAppNewsSharingConfigHistoryRecord" DROP COLUMN "pushNotificationPreviewSettings" CASCADE;
--
-- Add field customGetRecipientsCountersUrl to b2bappnewssharingconfighistoryrecord
--
ALTER TABLE "B2BAppNewsSharingConfigHistoryRecord" DROP COLUMN "customGetRecipientsCountersUrl" CASCADE;
--
-- Add field pushNotificationPreviewSettings to b2bappnewssharingconfig
--
ALTER TABLE "B2BAppNewsSharingConfig" DROP COLUMN "pushNotificationPreviewSettings" CASCADE;
--
-- Add field customGetRecipientsCountersUrl to b2bappnewssharingconfig
--
ALTER TABLE "B2BAppNewsSharingConfig" DROP COLUMN "customGetRecipientsCountersUrl" CASCADE;
--
-- Rename field lastPostRequest on newsitemsharinghistoryrecord to lastPublishResponse
--
ALTER TABLE "NewsItemSharingHistoryRecord" RENAME COLUMN "lastPublishResponse" TO "lastPostRequest";
--
-- Rename field lastPostRequest on newsitemsharing to lastPublishResponse
--
ALTER TABLE "NewsItemSharing" RENAME COLUMN "lastPublishResponse" TO "lastPostRequest";
COMMIT;

    `)
}
