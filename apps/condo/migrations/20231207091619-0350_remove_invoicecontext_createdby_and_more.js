// auto generated by kmigrator
// KMIGRATOR:0350_remove_invoicecontext_createdby_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMi40IG9uIDIwMjMtMTItMDcgMDQ6MTYKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAzNDlfYmlsbGluZ3JlY2VpcHRoaXN0b3J5cmVjb3JkX2lzcGF5YWJsZScpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiMgICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiMgICAgICAgICAgICBtb2RlbF9uYW1lPSdpbnZvaWNlY29udGV4dCcsCiMgICAgICAgICAgICBuYW1lPSdjcmVhdGVkQnknLAojICAgICAgICApLAojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0naW52b2ljZWNvbnRleHQnLAojICAgICAgICAgICAgbmFtZT0naW50ZWdyYXRpb24nLAojICAgICAgICApLAojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0naW52b2ljZWNvbnRleHQnLAojICAgICAgICAgICAgbmFtZT0nb3JnYW5pemF0aW9uJywKIyAgICAgICAgKSwKIyAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKIyAgICAgICAgICAgIG1vZGVsX25hbWU9J2ludm9pY2Vjb250ZXh0JywKIyAgICAgICAgICAgIG5hbWU9J3VwZGF0ZWRCeScsCiMgICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0naW52b2ljZScsCiAgICAgICAgICAgIG5hbWU9J2NvbnRleHQnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0naW52b2ljZWhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdjb250ZXh0JywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXJyaWdodHNzZXQnLAogICAgICAgICAgICBuYW1lPSdjYW5NYW5hZ2VJbnZvaWNlQ29udGV4dHMnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcnJpZ2h0c3NldCcsCiAgICAgICAgICAgIG5hbWU9J2NhblJlYWRJbnZvaWNlQ29udGV4dHMnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcnJpZ2h0c3NldGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdjYW5NYW5hZ2VJbnZvaWNlQ29udGV4dHMnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcnJpZ2h0c3NldGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdjYW5SZWFkSW52b2ljZUNvbnRleHRzJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FjcXVpcmluZ2ludGVncmF0aW9uY29udGV4dCcsCiAgICAgICAgICAgIG5hbWU9J2ludm9pY2VFbWFpbHMnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmNvbnRleHQnLAogICAgICAgICAgICBuYW1lPSdpbnZvaWNlSW1wbGljaXRGZWVEaXN0cmlidXRpb25TY2hlbWEnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmNvbnRleHQnLAogICAgICAgICAgICBuYW1lPSdpbnZvaWNlUmVhc29uJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYWNxdWlyaW5naW50ZWdyYXRpb25jb250ZXh0JywKICAgICAgICAgICAgbmFtZT0naW52b2ljZVJlY2lwaWVudCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FjcXVpcmluZ2ludGVncmF0aW9uY29udGV4dCcsCiAgICAgICAgICAgIG5hbWU9J2ludm9pY2VTYWxlc1RheFBlcmNlbnQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRGVjaW1hbEZpZWxkKGJsYW5rPVRydWUsIGRlY2ltYWxfcGxhY2VzPTQsIG1heF9kaWdpdHM9MTgsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmNvbnRleHQnLAogICAgICAgICAgICBuYW1lPSdpbnZvaWNlU3RhdHVzJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYWNxdWlyaW5naW50ZWdyYXRpb25jb250ZXh0JywKICAgICAgICAgICAgbmFtZT0naW52b2ljZVRheFJlZ2ltZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FjcXVpcmluZ2ludGVncmF0aW9uY29udGV4dCcsCiAgICAgICAgICAgIG5hbWU9J2ludm9pY2VWYXRQZXJjZW50JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYWNxdWlyaW5naW50ZWdyYXRpb25jb250ZXh0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2ludm9pY2VFbWFpbHMnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmNvbnRleHRoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naW52b2ljZUltcGxpY2l0RmVlRGlzdHJpYnV0aW9uU2NoZW1hJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkpTT05GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYWNxdWlyaW5naW50ZWdyYXRpb25jb250ZXh0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2ludm9pY2VSZWFzb24nLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmNvbnRleHRoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naW52b2ljZVJlY2lwaWVudCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FjcXVpcmluZ2ludGVncmF0aW9uY29udGV4dGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdpbnZvaWNlU2FsZXNUYXhQZXJjZW50JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkRlY2ltYWxGaWVsZChibGFuaz1UcnVlLCBkZWNpbWFsX3BsYWNlcz00LCBtYXhfZGlnaXRzPTE4LCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYWNxdWlyaW5naW50ZWdyYXRpb25jb250ZXh0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2ludm9pY2VTdGF0dXMnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmNvbnRleHRoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naW52b2ljZVRheFJlZ2ltZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FjcXVpcmluZ2ludGVncmF0aW9uY29udGV4dGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdpbnZvaWNlVmF0UGVyY2VudCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2ludm9pY2UnLAogICAgICAgICAgICBuYW1lPSdvcmdhbml6YXRpb24nLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRm9yZWlnbktleShkYl9jb2x1bW49J29yZ2FuaXphdGlvbicsIGRlZmF1bHQ9JycsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLkNBU0NBREUsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS5vcmdhbml6YXRpb24nKSwKICAgICAgICAgICAgcHJlc2VydmVfZGVmYXVsdD1GYWxzZSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2ludm9pY2VoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nb3JnYW5pemF0aW9uJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlVVSURGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5EZWxldGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0naW52b2ljZWNvbnRleHQnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5EZWxldGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0naW52b2ljZWNvbnRleHRoaXN0b3J5cmVjb3JkJywKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove field context from invoice
--
SET CONSTRAINTS "Invoice_context_f82e2da9_fk_InvoiceContext_id" IMMEDIATE; ALTER TABLE "Invoice" DROP CONSTRAINT "Invoice_context_f82e2da9_fk_InvoiceContext_id";
ALTER TABLE "Invoice" DROP COLUMN "context" CASCADE;
--
-- Remove field context from invoicehistoryrecord
--
ALTER TABLE "InvoiceHistoryRecord" DROP COLUMN "context" CASCADE;
--
-- Remove field canManageInvoiceContexts from userrightsset
--
ALTER TABLE "UserRightsSet" DROP COLUMN "canManageInvoiceContexts" CASCADE;
--
-- Remove field canReadInvoiceContexts from userrightsset
--
ALTER TABLE "UserRightsSet" DROP COLUMN "canReadInvoiceContexts" CASCADE;
--
-- Remove field canManageInvoiceContexts from userrightssethistoryrecord
--
ALTER TABLE "UserRightsSetHistoryRecord" DROP COLUMN "canManageInvoiceContexts" CASCADE;
--
-- Remove field canReadInvoiceContexts from userrightssethistoryrecord
--
ALTER TABLE "UserRightsSetHistoryRecord" DROP COLUMN "canReadInvoiceContexts" CASCADE;
--
-- Add field invoiceEmails to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceEmails" text NULL;
--
-- Add field invoiceImplicitFeeDistributionSchema to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceImplicitFeeDistributionSchema" jsonb NULL;
--
-- Add field invoiceReason to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceReason" text NULL;
--
-- Add field invoiceRecipient to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceRecipient" jsonb NULL;
--
-- Add field invoiceSalesTaxPercent to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceSalesTaxPercent" numeric(18, 4) NULL;
--
-- Add field invoiceStatus to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceStatus" text NULL;
--
-- Add field invoiceTaxRegime to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceTaxRegime" text NULL;
--
-- Add field invoiceVatPercent to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" ADD COLUMN "invoiceVatPercent" text NULL;
--
-- Add field invoiceEmails to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceEmails" text NULL;
--
-- Add field invoiceImplicitFeeDistributionSchema to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceImplicitFeeDistributionSchema" jsonb NULL;
--
-- Add field invoiceReason to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceReason" text NULL;
--
-- Add field invoiceRecipient to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceRecipient" jsonb NULL;
--
-- Add field invoiceSalesTaxPercent to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceSalesTaxPercent" numeric(18, 4) NULL;
--
-- Add field invoiceStatus to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceStatus" text NULL;
--
-- Add field invoiceTaxRegime to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceTaxRegime" text NULL;
--
-- Add field invoiceVatPercent to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" ADD COLUMN "invoiceVatPercent" text NULL;
--
-- Add field organization to invoice
--
ALTER TABLE "Invoice" ADD COLUMN "organization" uuid NOT NULL CONSTRAINT "Invoice_organization_d276dcc3_fk_Organization_id" REFERENCES "Organization"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Invoice_organization_d276dcc3_fk_Organization_id" IMMEDIATE;
--
-- Add field organization to invoicehistoryrecord
--
ALTER TABLE "InvoiceHistoryRecord" ADD COLUMN "organization" uuid NULL;
--
-- Delete model invoicecontext
--
DROP TABLE "InvoiceContext" CASCADE;
--
-- Delete model invoicecontexthistoryrecord
--
DROP TABLE "InvoiceContextHistoryRecord" CASCADE;
CREATE INDEX "Invoice_organization_d276dcc3" ON "Invoice" ("organization");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model invoicecontexthistoryrecord
--
CREATE TABLE "InvoiceContextHistoryRecord" ("organization" uuid NULL, "recipient" jsonb NULL, "settings" jsonb NULL, "status" text NULL, "implicitFeePercent" numeric(18, 4) NULL, "taxRegime" text NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "createdBy" uuid NULL, "updatedBy" uuid NULL, "deletedAt" timestamp with time zone NULL, "newId" jsonb NULL, "dv" integer NULL, "sender" jsonb NULL, "history_date" timestamp with time zone NOT NULL, "history_action" varchar(50) NOT NULL, "history_id" uuid NOT NULL, "vatPercent" text NULL, "currencyCode" text NULL, "salesTaxPercent" numeric(18, 4) NULL, "integration" uuid NULL);
--
-- Delete model invoicecontext
--
CREATE TABLE "InvoiceContext" ("recipient" jsonb NULL, "settings" jsonb NULL, "status" text NULL, "implicitFeePercent" numeric(18, 4) NOT NULL, "taxRegime" text NOT NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NOT NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "deletedAt" timestamp with time zone NULL, "newId" uuid NULL, "dv" integer NOT NULL, "sender" jsonb NOT NULL, "createdBy" uuid NULL, "organization" uuid NOT NULL, "updatedBy" uuid NULL, "vatPercent" text NULL, "currencyCode" text NOT NULL, "salesTaxPercent" numeric(18, 4) NULL, "integration" uuid NOT NULL);
--
-- Add field organization to invoicehistoryrecord
--
ALTER TABLE "InvoiceHistoryRecord" DROP COLUMN "organization" CASCADE;
--
-- Add field organization to invoice
--
ALTER TABLE "Invoice" DROP COLUMN "organization" CASCADE;
--
-- Add field invoiceVatPercent to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceVatPercent" CASCADE;
--
-- Add field invoiceTaxRegime to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceTaxRegime" CASCADE;
--
-- Add field invoiceStatus to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceStatus" CASCADE;
--
-- Add field invoiceSalesTaxPercent to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceSalesTaxPercent" CASCADE;
--
-- Add field invoiceRecipient to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceRecipient" CASCADE;
--
-- Add field invoiceReason to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceReason" CASCADE;
--
-- Add field invoiceImplicitFeeDistributionSchema to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceImplicitFeeDistributionSchema" CASCADE;
--
-- Add field invoiceEmails to acquiringintegrationcontexthistoryrecord
--
ALTER TABLE "AcquiringIntegrationContextHistoryRecord" DROP COLUMN "invoiceEmails" CASCADE;
--
-- Add field invoiceVatPercent to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceVatPercent" CASCADE;
--
-- Add field invoiceTaxRegime to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceTaxRegime" CASCADE;
--
-- Add field invoiceStatus to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceStatus" CASCADE;
--
-- Add field invoiceSalesTaxPercent to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceSalesTaxPercent" CASCADE;
--
-- Add field invoiceRecipient to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceRecipient" CASCADE;
--
-- Add field invoiceReason to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceReason" CASCADE;
--
-- Add field invoiceImplicitFeeDistributionSchema to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceImplicitFeeDistributionSchema" CASCADE;
--
-- Add field invoiceEmails to acquiringintegrationcontext
--
ALTER TABLE "AcquiringIntegrationContext" DROP COLUMN "invoiceEmails" CASCADE;
--
-- Remove field canReadInvoiceContexts from userrightssethistoryrecord
--
ALTER TABLE "UserRightsSetHistoryRecord" ADD COLUMN "canReadInvoiceContexts" boolean NULL;
--
-- Remove field canManageInvoiceContexts from userrightssethistoryrecord
--
ALTER TABLE "UserRightsSetHistoryRecord" ADD COLUMN "canManageInvoiceContexts" boolean NULL;
--
-- Remove field canReadInvoiceContexts from userrightsset
--
ALTER TABLE "UserRightsSet" ADD COLUMN "canReadInvoiceContexts" boolean NOT NULL;
--
-- Remove field canManageInvoiceContexts from userrightsset
--
ALTER TABLE "UserRightsSet" ADD COLUMN "canManageInvoiceContexts" boolean NOT NULL;
--
-- Remove field context from invoicehistoryrecord
--
ALTER TABLE "InvoiceHistoryRecord" ADD COLUMN "context" uuid NULL;
--
-- Remove field context from invoice
--
ALTER TABLE "Invoice" ADD COLUMN "context" uuid NOT NULL CONSTRAINT "Invoice_context_f82e2da9_fk_InvoiceContext_id" REFERENCES "InvoiceContext"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Invoice_context_f82e2da9_fk_InvoiceContext_id" IMMEDIATE;
CREATE INDEX "InvoiceContextHistoryRecord_history_id_fb1104ef" ON "InvoiceContextHistoryRecord" ("history_id");
ALTER TABLE "InvoiceContext" ADD CONSTRAINT "InvoiceContext_createdBy_1041b794_fk_User_id" FOREIGN KEY ("createdBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "InvoiceContext" ADD CONSTRAINT "InvoiceContext_organization_eac30293_fk_Organization_id" FOREIGN KEY ("organization") REFERENCES "Organization" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "InvoiceContext" ADD CONSTRAINT "InvoiceContext_updatedBy_dd2d2882_fk_User_id" FOREIGN KEY ("updatedBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "InvoiceContext" ADD CONSTRAINT "InvoiceContext_integration_cdad2d29_fk_AcquiringIntegration_id" FOREIGN KEY ("integration") REFERENCES "AcquiringIntegration" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE UNIQUE INDEX "invoiceContext_unique_organization" ON "InvoiceContext" ("organization") WHERE "deletedAt" IS NULL;
CREATE INDEX "InvoiceContext_createdAt_0a7a3706" ON "InvoiceContext" ("createdAt");
CREATE INDEX "InvoiceContext_updatedAt_3f822b30" ON "InvoiceContext" ("updatedAt");
CREATE INDEX "InvoiceContext_deletedAt_b9a1c5d5" ON "InvoiceContext" ("deletedAt");
CREATE INDEX "InvoiceContext_createdBy_1041b794" ON "InvoiceContext" ("createdBy");
CREATE INDEX "InvoiceContext_organization_eac30293" ON "InvoiceContext" ("organization");
CREATE INDEX "InvoiceContext_updatedBy_dd2d2882" ON "InvoiceContext" ("updatedBy");
CREATE INDEX "InvoiceContext_integration_cdad2d29" ON "InvoiceContext" ("integration");
CREATE INDEX "Invoice_context_f82e2da9" ON "Invoice" ("context");
COMMIT;

    `)
}
