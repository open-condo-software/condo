// auto generated by kmigrator
// KMIGRATOR:0446_auto_20241219_1452:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi41IG9uIDIwMjQtMTItMTkgMTQ6NTIKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzA0NDVfYXV0b18yMDI0MTIxOV8xMjQ5JyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUNvbnN0cmFpbnQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FwcG1lc3NhZ2VzZXR0aW5nJywKICAgICAgICAgICAgbmFtZT0nYXBwX21lc3NhZ2Vfc2V0dGluZ191bmlxdWVfYXBwX2FuZF90eXBlJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkQ29uc3RyYWludCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYXBwbWVzc2FnZXNldHRpbmcnLAogICAgICAgICAgICBjb25zdHJhaW50PW1vZGVscy5VbmlxdWVDb25zdHJhaW50KGNvbmRpdGlvbj1tb2RlbHMuUSgoJ2RlbGV0ZWRBdF9faXNudWxsJywgVHJ1ZSkpLCBmaWVsZHM9KCdiMmNBcHAnLCAndHlwZScpLCBuYW1lPSdhcHBfbWVzc2FnZV9zZXR0aW5nX3VuaXF1ZV9iMmNfYXBwX2FuZF90eXBlJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZENvbnN0cmFpbnQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2FwcG1lc3NhZ2VzZXR0aW5nJywKICAgICAgICAgICAgY29uc3RyYWludD1tb2RlbHMuVW5pcXVlQ29uc3RyYWludChjb25kaXRpb249bW9kZWxzLlEoKCdkZWxldGVkQXRfX2lzbnVsbCcsIFRydWUpKSwgZmllbGRzPSgnYjJiQXBwJywgJ3R5cGUnKSwgbmFtZT0nYXBwX21lc3NhZ2Vfc2V0dGluZ191bmlxdWVfYjJiX2FwcF9hbmRfdHlwZScpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove constraint app_message_setting_unique_app_and_type from model appmessagesetting
--
DROP INDEX IF EXISTS "app_message_setting_unique_app_and_type";
--
-- Create constraint app_message_setting_unique_b2c_app_and_type on model appmessagesetting
--
CREATE UNIQUE INDEX "app_message_setting_unique_b2c_app_and_type" ON "AppMessageSetting" ("b2cApp", "type") WHERE "deletedAt" IS NULL;
--
-- Create constraint app_message_setting_unique_b2b_app_and_type on model appmessagesetting
--
CREATE UNIQUE INDEX "app_message_setting_unique_b2b_app_and_type" ON "AppMessageSetting" ("b2bApp", "type") WHERE "deletedAt" IS NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create constraint app_message_setting_unique_b2b_app_and_type on model appmessagesetting
--
DROP INDEX IF EXISTS "app_message_setting_unique_b2b_app_and_type";
--
-- Create constraint app_message_setting_unique_b2c_app_and_type on model appmessagesetting
--
DROP INDEX IF EXISTS "app_message_setting_unique_b2c_app_and_type";
--
-- Remove constraint app_message_setting_unique_app_and_type from model appmessagesetting
--
CREATE UNIQUE INDEX "app_message_setting_unique_app_and_type" ON "AppMessageSetting" ("b2cApp", "b2bApp", "type") WHERE "deletedAt" IS NULL;
COMMIT;

    `)
}
