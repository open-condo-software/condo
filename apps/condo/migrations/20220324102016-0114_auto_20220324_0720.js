// auto generated by kmigrator
// KMIGRATOR:0114_auto_20220324_0720:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi40IG9uIDIwMjItMDMtMjQgMDc6MjAKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAxMTNfYXV0b18yMDIyMDMxNV8wNjEzJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUNvbnN0cmFpbnQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2JpbGxpbmdyZWNpcGllbnQnLAogICAgICAgICAgICBuYW1lPSdiaWxsaW5nUmVjaXBpZW50X3VuaXF1ZV9jb250ZXh0X3Rpbl9pZWNfYmljX2JhbmtBY2NvdW50JywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkQ29uc3RyYWludCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYmlsbGluZ3JlY2lwaWVudCcsCiAgICAgICAgICAgIGNvbnN0cmFpbnQ9bW9kZWxzLlVuaXF1ZUNvbnN0cmFpbnQoY29uZGl0aW9uPW1vZGVscy5RKCgnZGVsZXRlZEF0X19pc251bGwnLCBUcnVlKSksIGZpZWxkcz0oJ2NvbnRleHQnLCAndGluJywgJ2llYycsICdiaWMnLCAnYmFua0FjY291bnQnKSwgbmFtZT0nYmlsbGluZ1JlY2lwaWVudF91bmlxdWVfY29udGV4dF90aW5faWVjX2JpY19iYW5rQWNjb3VudCcpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove constraint billingRecipient_unique_context_tin_iec_bic_bankAccount from model billingrecipient
--
ALTER TABLE "BillingRecipient" DROP CONSTRAINT "billingRecipient_unique_context_tin_iec_bic_bankAccount";
--
-- Create constraint billingRecipient_unique_context_tin_iec_bic_bankAccount on model billingrecipient
--
CREATE UNIQUE INDEX "billingRecipient_unique_context_tin_iec_bic_bankAccount" ON "BillingRecipient" ("context", "tin", "iec", "bic", "bankAccount") WHERE "deletedAt" IS NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create constraint billingRecipient_unique_context_tin_iec_bic_bankAccount on model billingrecipient
--
DROP INDEX IF EXISTS "billingRecipient_unique_context_tin_iec_bic_bankAccount";
--
-- Remove constraint billingRecipient_unique_context_tin_iec_bic_bankAccount from model billingrecipient
--
ALTER TABLE "BillingRecipient" ADD CONSTRAINT "billingRecipient_unique_context_tin_iec_bic_bankAccount" UNIQUE ("context", "tin", "iec", "bic", "bankAccount");
COMMIT;

    `)
}
