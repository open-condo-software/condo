// auto generated by kmigrator
// KMIGRATOR:0081_auto_20211118_0558:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi41IG9uIDIwMjEtMTEtMTggMDU6NTgKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwODBfYXV0b18yMDIxMTExMV8xNDQwJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXQnLAogICAgICAgICAgICBuYW1lPSdvcmRlcicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5JbnRlZ2VyRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGNoYW5nZScsCiAgICAgICAgICAgIG5hbWU9J29yZGVyRnJvbScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5JbnRlZ2VyRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGNoYW5nZScsCiAgICAgICAgICAgIG5hbWU9J29yZGVyVG8nLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSW50ZWdlckZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nb3JkZXInLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSW50ZWdlckZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field order to ticket
--
ALTER TABLE "Ticket" ADD COLUMN "order" integer NULL;
--
-- Add field orderFrom to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "orderFrom" integer NULL;
--
-- Add field orderTo to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "orderTo" integer NULL;
--
-- Add field order to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" ADD COLUMN "order" integer NULL;

    UPDATE "Ticket" SET "order" = 100 WHERE "id" = '6ef3abc4-022f-481b-90fb-8430345ebfc2';
--    UPDATE "Ticket" SET "order" = 200 WHERE "id" = 'aa5ed9c2-90ca-4042-8194-d3ed23cb7919';
--    UPDATE "Ticket" SET "order" = 300 WHERE "id" = 'f0fa0093-8d86-4e69-ae1a-70a2914da82f'; 
--    UPDATE "Ticket" SET "order" = 400 WHERE "id" = '5b9decd7-792c-42bb-b16d-822142fd2d69';
--    UPDATE "Ticket" SET "order" = 500 WHERE "id" = 'c14a58e0-6b5d-4ec2-b91c-980a90509c7f';
--    UPDATE "Ticket" SET "order" = 600 WHERE "id" = 'c14a58e0-6b5d-4ec2-b91c-980a90111c7d';

COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field order to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" DROP COLUMN "order" CASCADE;
--
-- Add field orderTo to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "orderTo" CASCADE;
--
-- Add field orderFrom to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "orderFrom" CASCADE;
--
-- Add field order to ticket
--
ALTER TABLE "Ticket" DROP COLUMN "order" CASCADE;
COMMIT;

    `)
}
