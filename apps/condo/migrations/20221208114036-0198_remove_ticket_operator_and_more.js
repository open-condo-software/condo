// auto generated by kmigrator
// KMIGRATOR:0198_remove_ticket_operator_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMSBvbiAyMDIyLTEyLTA4IDA2OjQwCgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucwoKCmNsYXNzIE1pZ3JhdGlvbihtaWdyYXRpb25zLk1pZ3JhdGlvbik6CgogICAgZGVwZW5kZW5jaWVzID0gWwogICAgICAgICgnX2RqYW5nb19zY2hlbWEnLCAnMDE5Nl9jb250YWN0X2NvbnRhY3RfdW5pcXVlX3Byb3BlcnR5X3VuaXRuYW1lX3VuaXR0eXBlX3Bob25lJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXQnLAogICAgICAgICAgICBuYW1lPSdvcGVyYXRvcicsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSdvcGVyYXRvckRpc3BsYXlOYW1lRnJvbScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSdvcGVyYXRvckRpc3BsYXlOYW1lVG8nLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0Y2hhbmdlJywKICAgICAgICAgICAgbmFtZT0nb3BlcmF0b3JJZEZyb20nLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0Y2hhbmdlJywKICAgICAgICAgICAgbmFtZT0nb3BlcmF0b3JJZFRvJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdvcGVyYXRvcicsCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove field operator from ticket
--
-- SET CONSTRAINTS "Ticket_operator_22582fe1_fk_User_id" IMMEDIATE; ALTER TABLE "Ticket" DROP CONSTRAINT "Ticket_operator_22582fe1_fk_User_id";
-- ALTER TABLE "Ticket" DROP COLUMN "operator" CASCADE;
--
-- Remove field operatorDisplayNameFrom from ticketchange
--
-- ALTER TABLE "TicketChange" DROP COLUMN "operatorDisplayNameFrom" CASCADE;
--
-- Remove field operatorDisplayNameTo from ticketchange
--
-- ALTER TABLE "TicketChange" DROP COLUMN "operatorDisplayNameTo" CASCADE;
--
-- Remove field operatorIdFrom from ticketchange
--
-- ALTER TABLE "TicketChange" DROP COLUMN "operatorIdFrom" CASCADE;
--
-- Remove field operatorIdTo from ticketchange
--
-- ALTER TABLE "TicketChange" DROP COLUMN "operatorIdTo" CASCADE;
--
-- Remove field operator from tickethistoryrecord
--
-- ALTER TABLE "TicketHistoryRecord" DROP COLUMN "operator" CASCADE;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove field operator from tickethistoryrecord
--
-- ALTER TABLE "TicketHistoryRecord" ADD COLUMN "operator" uuid NULL;
--
-- Remove field operatorIdTo from ticketchange
--
-- ALTER TABLE "TicketChange" ADD COLUMN "operatorIdTo" uuid NULL;
--
-- Remove field operatorIdFrom from ticketchange
--
-- ALTER TABLE "TicketChange" ADD COLUMN "operatorIdFrom" uuid NULL;
--
-- Remove field operatorDisplayNameTo from ticketchange
--
-- ALTER TABLE "TicketChange" ADD COLUMN "operatorDisplayNameTo" text NULL;
--
-- Remove field operatorDisplayNameFrom from ticketchange
--
-- ALTER TABLE "TicketChange" ADD COLUMN "operatorDisplayNameFrom" text NULL;
--
-- Remove field operator from ticket
--
-- ALTER TABLE "Ticket" ADD COLUMN "operator" uuid NULL CONSTRAINT "Ticket_operator_22582fe1_fk_User_id" REFERENCES "User"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Ticket_operator_22582fe1_fk_User_id" IMMEDIATE;
-- CREATE INDEX "Ticket_operator_22582fe1" ON "Ticket" ("operator");
COMMIT;

    `)
}
