// auto generated by kmigrator
// KMIGRATOR:0227_auto_20230227_1430:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi40IG9uIDIwMjMtMDItMjcgMTQ6MzAKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAyMjZfYXV0b18yMDIzMDIyN18xMDU5JyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbicsCiAgICAgICAgICAgIG5hbWU9J3N1cHBvcnRlZEJpbGxpbmdJbnRlZ3JhdGlvbnNHcm91cCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoZGVmYXVsdD0nY29tbW9uJyksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdzdXBwb3J0ZWRCaWxsaW5nSW50ZWdyYXRpb25zR3JvdXAnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiaWxsaW5naW50ZWdyYXRpb24nLAogICAgICAgICAgICBuYW1lPSdncm91cCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoZGVmYXVsdD0nY29tbW9uJyksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiaWxsaW5naW50ZWdyYXRpb25oaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nZ3JvdXAnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkRlbGV0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSdhY3F1aXJpbmdpbnRlZ3JhdGlvbl9zdXBwb3J0ZWRiaWxsaW5naW50ZWdyYXRpb25zX21hbnknLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field supportedBillingIntegrationsGroup to acquiringintegration
--
ALTER TABLE "AcquiringIntegration" ADD COLUMN "supportedBillingIntegrationsGroup" text DEFAULT 'common' NOT NULL;
ALTER TABLE "AcquiringIntegration" ALTER COLUMN "supportedBillingIntegrationsGroup" DROP DEFAULT;
--
-- Add field supportedBillingIntegrationsGroup to acquiringintegrationhistoryrecord
--
ALTER TABLE "AcquiringIntegrationHistoryRecord" ADD COLUMN "supportedBillingIntegrationsGroup" text NULL;
--
-- Add field group to billingintegration
--
ALTER TABLE "BillingIntegration" ADD COLUMN "group" text DEFAULT 'common' NOT NULL;
ALTER TABLE "BillingIntegration" ALTER COLUMN "group" DROP DEFAULT;
--
-- Add field group to billingintegrationhistoryrecord
--
ALTER TABLE "BillingIntegrationHistoryRecord" ADD COLUMN "group" text NULL;
--
-- Delete model acquiringintegration_supportedbillingintegrations_many
--
DROP TABLE "AcquiringIntegration_supportedBillingIntegrations_many" CASCADE;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model acquiringintegration_supportedbillingintegrations_many
--
CREATE TABLE "AcquiringIntegration_supportedBillingIntegrations_many" ("id" serial NOT NULL PRIMARY KEY, "AcquiringIntegration_left_id" uuid NOT NULL, "BillingIntegration_right_id" uuid NOT NULL);
--
-- Add field group to billingintegrationhistoryrecord
--
ALTER TABLE "BillingIntegrationHistoryRecord" DROP COLUMN "group" CASCADE;
--
-- Add field group to billingintegration
--
ALTER TABLE "BillingIntegration" DROP COLUMN "group" CASCADE;
--
-- Add field supportedBillingIntegrationsGroup to acquiringintegrationhistoryrecord
--
ALTER TABLE "AcquiringIntegrationHistoryRecord" DROP COLUMN "supportedBillingIntegrationsGroup" CASCADE;
--
-- Add field supportedBillingIntegrationsGroup to acquiringintegration
--
ALTER TABLE "AcquiringIntegration" DROP COLUMN "supportedBillingIntegrationsGroup" CASCADE;
ALTER TABLE "AcquiringIntegration_supportedBillingIntegrations_many" ADD CONSTRAINT "AcquiringIntegration_AcquiringIntegration_18123c45_fk_Acquiring" FOREIGN KEY ("AcquiringIntegration_left_id") REFERENCES "AcquiringIntegration" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "AcquiringIntegration_supportedBillingIntegrations_many" ADD CONSTRAINT "AcquiringIntegration_BillingIntegration_r_81b2c80c_fk_BillingIn" FOREIGN KEY ("BillingIntegration_right_id") REFERENCES "BillingIntegration" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "AcquiringIntegration_suppo_AcquiringIntegration_left__18123c45" ON "AcquiringIntegration_supportedBillingIntegrations_many" ("AcquiringIntegration_left_id");
CREATE INDEX "AcquiringIntegration_suppo_BillingIntegration_right_i_81b2c80c" ON "AcquiringIntegration_supportedBillingIntegrations_many" ("BillingIntegration_right_id");
COMMIT;

    `)
}
