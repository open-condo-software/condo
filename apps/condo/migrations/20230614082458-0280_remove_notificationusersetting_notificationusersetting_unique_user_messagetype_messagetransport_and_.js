// auto generated by kmigrator
// KMIGRATOR:0280_remove_notificationusersetting_notificationusersetting_unique_user_messagetype_messagetransport_and_:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMC4xIG9uIDIwMjMtMDYtMTQgMDM6MjQKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAyNzlfbmV3c2l0ZW1fbnVtYmVyX25ld3NpdGVtaGlzdG9yeXJlY29yZF9udW1iZXInKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlQ29uc3RyYWludCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbm90aWZpY2F0aW9udXNlcnNldHRpbmcnLAogICAgICAgICAgICBuYW1lPSdOb3RpZmljYXRpb25Vc2VyU2V0dGluZ191bmlxdWVfdXNlcl9tZXNzYWdlVHlwZV9tZXNzYWdlVHJhbnNwb3J0JywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkQ29uc3RyYWludCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbm90aWZpY2F0aW9udXNlcnNldHRpbmcnLAogICAgICAgICAgICBjb25zdHJhaW50PW1vZGVscy5VbmlxdWVDb25zdHJhaW50KGNvbmRpdGlvbj1tb2RlbHMuUSgoJ2RlbGV0ZWRBdF9faXNudWxsJywgVHJ1ZSkpLCBmaWVsZHM9KCd1c2VyJywgJ21lc3NhZ2VUeXBlJywgJ21lc3NhZ2VUcmFuc3BvcnQnKSwgbmFtZT0nTm90aWZpY2F0aW9uVXNlclNldHRpbmdfdW5pcXVlX3VzZXJfbWVzc2FnZVR5cGVfbWVzc2FnZVRyYW5zcG9ydCcpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove constraint NotificationUserSetting_unique_user_messageType_messageTransport from model notificationusersetting
--
ALTER TABLE "NotificationUserSetting" DROP CONSTRAINT "NotificationUserSetting_unique_user_messageType_messageTransport";
--
-- Create constraint NotificationUserSetting_unique_user_messageType_messageTransport on model notificationusersetting
--
CREATE UNIQUE INDEX "NotificationUserSetting_unique_user_messageType_messageTransport" ON "NotificationUserSetting" ("user", "messageType", "messageTransport") WHERE "deletedAt" IS NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create constraint NotificationUserSetting_unique_user_messageType_messageTransport on model notificationusersetting
--
DROP INDEX IF EXISTS "NotificationUserSetting_unique_user_messageType_messageTransport";
--
-- Remove constraint NotificationUserSetting_unique_user_messageType_messageTransport from model notificationusersetting
--
ALTER TABLE "NotificationUserSetting" ADD CONSTRAINT "NotificationUserSetting_unique_user_messageType_messageTransport" UNIQUE ("user", "messageType", "messageTransport");
COMMIT;

    `)
}
