// auto generated by kmigrator
// KMIGRATOR:0421_auto_20240905_0712:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi41IG9uIDIwMjQtMDktMDUgMDc6MTIKCmltcG9ydCBkamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5pbmRleGVzCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwNDIwX2FjcXVpcmluZ2ludGVncmF0aW9uX21pbmltdW1wYXltZW50YW1vdW50X2FuZF9tb3JlJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEluZGV4KAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXQnLAogICAgICAgICAgICBpbmRleD1kamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5pbmRleGVzLkJUcmVlSW5kZXgoZmllbGRzPVsndW5pdE5hbWUnXSwgbmFtZT0ndGlja2V0X3VuaXROYW1lJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEluZGV4KAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXQnLAogICAgICAgICAgICBpbmRleD1kamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5pbmRleGVzLkJUcmVlSW5kZXgoZmllbGRzPVsnYXNzaWduZWUnLCAnZXhlY3V0b3InLCAnb3JnYW5pemF0aW9uJ10sIG5hbWU9J3RpY2tldF9hc3NpZ25lZV9leGVjX29yZycpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRJbmRleCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0JywKICAgICAgICAgICAgaW5kZXg9ZGphbmdvLmNvbnRyaWIucG9zdGdyZXMuaW5kZXhlcy5CVHJlZUluZGV4KGZpZWxkcz1bJ29yZ2FuaXphdGlvbicsICdzdGF0dXMnXSwgbmFtZT0ndGlja2V0X29yZ2FuaXphdGlvbl9zdGF0dXMnKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkSW5kZXgoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldCcsCiAgICAgICAgICAgIGluZGV4PWRqYW5nby5jb250cmliLnBvc3RncmVzLmluZGV4ZXMuQlRyZWVJbmRleChmaWVsZHM9WydvcmRlcicsICctY3JlYXRlZEF0J10sIG5hbWU9J3RpY2tldF9vcmRlcl9jcmVhdGVkYXQnKSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
--
SET statement_timeout = '1500s';

--
-- Create index ticket_unitName on field(s) unitName of model ticket
--
CREATE INDEX IF NOT EXISTS "ticket_unitName" ON "Ticket" USING btree ("unitName");
--
-- Create index ticket_assignee_exec_org on field(s) assignee, executor, organization of model ticket
--
CREATE INDEX IF NOT EXISTS "ticket_assignee_exec_org" ON "Ticket" USING btree ("assignee", "executor", "organization");
--
-- Create index ticket_organization_status on field(s) organization, status of model ticket
--
CREATE INDEX IF NOT EXISTS "ticket_organization_status" ON "Ticket" USING btree ("organization", "status");
--
-- Create index ticket_order_createdat on field(s) order, -createdAt of model ticket
--
CREATE INDEX IF NOT EXISTS "ticket_order_createdat" ON "Ticket" USING btree ("order", "createdAt" DESC);

--
-- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
--
SET statement_timeout = '10s';
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
--
SET statement_timeout = '1500s';

--
-- Create index ticket_order_createdat on field(s) order, -createdAt of model ticket
--
DROP INDEX IF EXISTS "ticket_order_createdat";
--
-- Create index ticket_organization_status on field(s) organization, status of model ticket
--
DROP INDEX IF EXISTS "ticket_organization_status";
--
-- Create index ticket_assignee_exec_org on field(s) assignee, executor, organization of model ticket
--
DROP INDEX IF EXISTS "ticket_assignee_exec_org";
--
-- Create index ticket_unitName on field(s) unitName of model ticket
--
DROP INDEX IF EXISTS "ticket_unitName";

--
-- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
--
SET statement_timeout = '10s';
COMMIT;

    `)
}
