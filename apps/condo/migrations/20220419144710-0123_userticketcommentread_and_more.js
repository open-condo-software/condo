// auto generated by kmigrator
// KMIGRATOR:0123_userticketcommentread_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMCBvbiAyMDIyLTA0LTE5IDA5OjQ3Cgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucywgbW9kZWxzCmltcG9ydCBkamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwMTIyX3RpY2tldGNvbW1lbnRmaWxlaGlzdG9yeXJlY29yZF9hbmRfbW9yZScpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5DcmVhdGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0ndXNlcnRpY2tldGNvbW1lbnRyZWFkJywKICAgICAgICAgICAgZmllbGRzPVsKICAgICAgICAgICAgICAgICgnZHYnLCBtb2RlbHMuSW50ZWdlckZpZWxkKCkpLAogICAgICAgICAgICAgICAgKCdzZW5kZXInLCBtb2RlbHMuSlNPTkZpZWxkKCkpLAogICAgICAgICAgICAgICAgKCdyZWFkUmVzaWRlbnRDb21tZW50QXQnLCBtb2RlbHMuRGF0ZVRpbWVGaWVsZCgpKSwKICAgICAgICAgICAgICAgICgnaWQnLCBtb2RlbHMuVVVJREZpZWxkKHByaW1hcnlfa2V5PVRydWUsIHNlcmlhbGl6ZT1GYWxzZSkpLAogICAgICAgICAgICAgICAgKCd2JywgbW9kZWxzLkludGVnZXJGaWVsZChkZWZhdWx0PTEpKSwKICAgICAgICAgICAgICAgICgnY3JlYXRlZEF0JywgbW9kZWxzLkRhdGVUaW1lRmllbGQoYmxhbms9VHJ1ZSwgZGJfaW5kZXg9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ3VwZGF0ZWRBdCcsIG1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIGRiX2luZGV4PVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdkZWxldGVkQXQnLCBtb2RlbHMuRGF0ZVRpbWVGaWVsZChibGFuaz1UcnVlLCBkYl9pbmRleD1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgnbmV3SWQnLCBtb2RlbHMuVVVJREZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdjcmVhdGVkQnknLCBtb2RlbHMuRm9yZWlnbktleShibGFuaz1UcnVlLCBkYl9jb2x1bW49J2NyZWF0ZWRCeScsIG51bGw9VHJ1ZSwgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uU0VUX05VTEwsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS51c2VyJykpLAogICAgICAgICAgICBdLAogICAgICAgICAgICBvcHRpb25zPXsKICAgICAgICAgICAgICAgICdkYl90YWJsZSc6ICdVc2VyVGlja2V0Q29tbWVudFJlYWQnLAogICAgICAgICAgICB9LAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5DcmVhdGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0ndXNlcnRpY2tldGNvbW1lbnRyZWFkaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIGZpZWxkcz1bCiAgICAgICAgICAgICAgICAoJ2R2JywgbW9kZWxzLkludGVnZXJGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgnc2VuZGVyJywgbW9kZWxzLkpTT05GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgndXNlcicsIG1vZGVscy5VVUlERmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ3RpY2tldCcsIG1vZGVscy5VVUlERmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ3JlYWRSZXNpZGVudENvbW1lbnRBdCcsIG1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdpZCcsIG1vZGVscy5VVUlERmllbGQocHJpbWFyeV9rZXk9VHJ1ZSwgc2VyaWFsaXplPUZhbHNlKSksCiAgICAgICAgICAgICAgICAoJ3YnLCBtb2RlbHMuSW50ZWdlckZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdjcmVhdGVkQXQnLCBtb2RlbHMuRGF0ZVRpbWVGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgndXBkYXRlZEF0JywgbW9kZWxzLkRhdGVUaW1lRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ2NyZWF0ZWRCeScsIG1vZGVscy5VVUlERmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ3VwZGF0ZWRCeScsIG1vZGVscy5VVUlERmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ2RlbGV0ZWRBdCcsIG1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCduZXdJZCcsIG1vZGVscy5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ2hpc3RvcnlfZGF0ZScsIG1vZGVscy5EYXRlVGltZUZpZWxkKCkpLAogICAgICAgICAgICAgICAgKCdoaXN0b3J5X2FjdGlvbicsIG1vZGVscy5DaGFyRmllbGQoY2hvaWNlcz1bKCdjJywgJ2MnKSwgKCd1JywgJ3UnKSwgKCdkJywgJ2QnKV0sIG1heF9sZW5ndGg9NTApKSwKICAgICAgICAgICAgICAgICgnaGlzdG9yeV9pZCcsIG1vZGVscy5VVUlERmllbGQoZGJfaW5kZXg9VHJ1ZSkpLAogICAgICAgICAgICBdLAogICAgICAgICAgICBvcHRpb25zPXsKICAgICAgICAgICAgICAgICdkYl90YWJsZSc6ICdVc2VyVGlja2V0Q29tbWVudFJlYWRIaXN0b3J5UmVjb3JkJywKICAgICAgICAgICAgfSwKICAgICAgICApLAojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0Y29tbWVudGZpbGUnLAojICAgICAgICAgICAgbmFtZT0nY3JlYXRlZEJ5JywKIyAgICAgICAgKSwKIyAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKIyAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGNvbW1lbnRmaWxlJywKIyAgICAgICAgICAgIG5hbWU9J29yZ2FuaXphdGlvbicsCiMgICAgICAgICksCiMgICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiMgICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjb21tZW50ZmlsZScsCiMgICAgICAgICAgICBuYW1lPSd0aWNrZXQnLAojICAgICAgICApLAojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0Y29tbWVudGZpbGUnLAojICAgICAgICAgICAgbmFtZT0ndGlja2V0Q29tbWVudCcsCiMgICAgICAgICksCiMgICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiMgICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjb21tZW50ZmlsZScsCiMgICAgICAgICAgICBuYW1lPSd1cGRhdGVkQnknLAojICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldCcsCiAgICAgICAgICAgIG5hbWU9J2xhc3RFbXBsb3llZUFuc3dlcmVkVG9SZXNpZGVudEF0JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkRhdGVUaW1lRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldCcsCiAgICAgICAgICAgIG5hbWU9J2xhc3RSZXNpZGVudENvbW1lbnRBdCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSdsYXN0RW1wbG95ZWVBbnN3ZXJlZFRvUmVzaWRlbnRBdEZyb20nLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRGF0ZVRpbWVGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGlja2V0Y2hhbmdlJywKICAgICAgICAgICAgbmFtZT0nbGFzdEVtcGxveWVlQW5zd2VyZWRUb1Jlc2lkZW50QXRUbycsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRjaGFuZ2UnLAogICAgICAgICAgICBuYW1lPSdsYXN0UmVzaWRlbnRDb21tZW50QXRGcm9tJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkRhdGVUaW1lRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGNoYW5nZScsCiAgICAgICAgICAgIG5hbWU9J2xhc3RSZXNpZGVudENvbW1lbnRBdFRvJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkRhdGVUaW1lRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3RpY2tldGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdsYXN0RW1wbG95ZWVBbnN3ZXJlZFRvUmVzaWRlbnRBdCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0aWNrZXRoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0nbGFzdFJlc2lkZW50Q29tbWVudEF0JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkRhdGVUaW1lRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXJ0aWNrZXRjb21tZW50cmVhZCcsCiAgICAgICAgICAgIG5hbWU9J3RpY2tldCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGRiX2NvbHVtbj0ndGlja2V0Jywgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uQ0FTQ0FERSwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLnRpY2tldCcpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcnRpY2tldGNvbW1lbnRyZWFkJywKICAgICAgICAgICAgbmFtZT0ndXBkYXRlZEJ5JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoYmxhbms9VHJ1ZSwgZGJfY29sdW1uPSd1cGRhdGVkQnknLCBudWxsPVRydWUsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLlNFVF9OVUxMLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEudXNlcicpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcnRpY2tldGNvbW1lbnRyZWFkJywKICAgICAgICAgICAgbmFtZT0ndXNlcicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGRiX2NvbHVtbj0ndXNlcicsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLkNBU0NBREUsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS51c2VyJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkRlbGV0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSd0aWNrZXRjb21tZW50ZmlsZScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkRlbGV0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSd0aWNrZXRjb21tZW50ZmlsZWhpc3RvcnlyZWNvcmQnLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create model userticketcommentread
--
CREATE TABLE "UserTicketCommentRead" ("dv" integer NOT NULL, "sender" jsonb NOT NULL, "readResidentCommentAt" timestamp with time zone NOT NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NOT NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "deletedAt" timestamp with time zone NULL, "newId" uuid NULL, "createdBy" uuid NULL);
--
-- Create model userticketcommentreadhistoryrecord
--
CREATE TABLE "UserTicketCommentReadHistoryRecord" ("dv" integer NULL, "sender" jsonb NULL, "user" uuid NULL, "ticket" uuid NULL, "readResidentCommentAt" timestamp with time zone NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "createdBy" uuid NULL, "updatedBy" uuid NULL, "deletedAt" timestamp with time zone NULL, "newId" jsonb NULL, "history_date" timestamp with time zone NOT NULL, "history_action" varchar(50) NOT NULL, "history_id" uuid NOT NULL);
--
-- Add field lastEmployeeAnsweredToResidentAt to ticket
--
ALTER TABLE "Ticket" ADD COLUMN "lastEmployeeAnsweredToResidentAt" timestamp with time zone NULL;
--
-- Add field lastResidentCommentAt to ticket
--
ALTER TABLE "Ticket" ADD COLUMN "lastResidentCommentAt" timestamp with time zone NULL;
--
-- Add field lastEmployeeAnsweredToResidentAtFrom to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "lastEmployeeAnsweredToResidentAtFrom" timestamp with time zone NULL;
--
-- Add field lastEmployeeAnsweredToResidentAtTo to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "lastEmployeeAnsweredToResidentAtTo" timestamp with time zone NULL;
--
-- Add field lastResidentCommentAtFrom to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "lastResidentCommentAtFrom" timestamp with time zone NULL;
--
-- Add field lastResidentCommentAtTo to ticketchange
--
ALTER TABLE "TicketChange" ADD COLUMN "lastResidentCommentAtTo" timestamp with time zone NULL;
--
-- Add field lastEmployeeAnsweredToResidentAt to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" ADD COLUMN "lastEmployeeAnsweredToResidentAt" timestamp with time zone NULL;
--
-- Add field lastResidentCommentAt to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" ADD COLUMN "lastResidentCommentAt" timestamp with time zone NULL;
--
-- Add field ticket to userticketcommentread
--
ALTER TABLE "UserTicketCommentRead" ADD COLUMN "ticket" uuid NOT NULL CONSTRAINT "UserTicketCommentRead_ticket_441799de_fk_Ticket_id" REFERENCES "Ticket"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "UserTicketCommentRead_ticket_441799de_fk_Ticket_id" IMMEDIATE;
--
-- Add field updatedBy to userticketcommentread
--
ALTER TABLE "UserTicketCommentRead" ADD COLUMN "updatedBy" uuid NULL CONSTRAINT "UserTicketCommentRead_updatedBy_808a2a08_fk_User_id" REFERENCES "User"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "UserTicketCommentRead_updatedBy_808a2a08_fk_User_id" IMMEDIATE;
--
-- Add field user to userticketcommentread
--
ALTER TABLE "UserTicketCommentRead" ADD COLUMN "user" uuid NOT NULL CONSTRAINT "UserTicketCommentRead_user_bcd6e715_fk_User_id" REFERENCES "User"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "UserTicketCommentRead_user_bcd6e715_fk_User_id" IMMEDIATE;
--
-- Delete model ticketcommentfile
--
DROP TABLE "TicketCommentFile" CASCADE;
--
-- Delete model ticketcommentfilehistoryrecord
--
DROP TABLE "TicketCommentFileHistoryRecord" CASCADE;
ALTER TABLE "UserTicketCommentRead" ADD CONSTRAINT "UserTicketCommentRead_createdBy_48aed1f3_fk_User_id" FOREIGN KEY ("createdBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "UserTicketCommentRead_createdAt_3c4ace7e" ON "UserTicketCommentRead" ("createdAt");
CREATE INDEX "UserTicketCommentRead_updatedAt_3e7705f2" ON "UserTicketCommentRead" ("updatedAt");
CREATE INDEX "UserTicketCommentRead_deletedAt_a756c9b2" ON "UserTicketCommentRead" ("deletedAt");
CREATE INDEX "UserTicketCommentRead_createdBy_48aed1f3" ON "UserTicketCommentRead" ("createdBy");
CREATE INDEX "UserTicketCommentReadHistoryRecord_history_id_982ad32c" ON "UserTicketCommentReadHistoryRecord" ("history_id");
CREATE INDEX "UserTicketCommentRead_ticket_441799de" ON "UserTicketCommentRead" ("ticket");
CREATE INDEX "UserTicketCommentRead_updatedBy_808a2a08" ON "UserTicketCommentRead" ("updatedBy");
CREATE INDEX "UserTicketCommentRead_user_bcd6e715" ON "UserTicketCommentRead" ("user");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model ticketcommentfilehistoryrecord
--
CREATE TABLE "TicketCommentFileHistoryRecord" ("dv" integer NULL, "sender" jsonb NULL, "organization" uuid NULL, "file" jsonb NULL, "ticket" uuid NULL, "ticketComment" uuid NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "createdBy" uuid NULL, "updatedBy" uuid NULL, "deletedAt" timestamp with time zone NULL, "newId" jsonb NULL, "history_date" timestamp with time zone NOT NULL, "history_action" varchar(50) NOT NULL, "history_id" uuid NOT NULL);
--
-- Delete model ticketcommentfile
--
CREATE TABLE "TicketCommentFile" ("dv" integer NOT NULL, "sender" jsonb NOT NULL, "file" jsonb NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NOT NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "deletedAt" timestamp with time zone NULL, "newId" uuid NULL, "createdBy" uuid NULL, "organization" uuid NOT NULL, "ticket" uuid NULL, "ticketComment" uuid NULL, "updatedBy" uuid NULL);
--
-- Add field user to userticketcommentread
--
ALTER TABLE "UserTicketCommentRead" DROP COLUMN "user" CASCADE;
--
-- Add field updatedBy to userticketcommentread
--
ALTER TABLE "UserTicketCommentRead" DROP COLUMN "updatedBy" CASCADE;
--
-- Add field ticket to userticketcommentread
--
ALTER TABLE "UserTicketCommentRead" DROP COLUMN "ticket" CASCADE;
--
-- Add field lastResidentCommentAt to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" DROP COLUMN "lastResidentCommentAt" CASCADE;
--
-- Add field lastEmployeeAnsweredToResidentAt to tickethistoryrecord
--
ALTER TABLE "TicketHistoryRecord" DROP COLUMN "lastEmployeeAnsweredToResidentAt" CASCADE;
--
-- Add field lastResidentCommentAtTo to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "lastResidentCommentAtTo" CASCADE;
--
-- Add field lastResidentCommentAtFrom to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "lastResidentCommentAtFrom" CASCADE;
--
-- Add field lastEmployeeAnsweredToResidentAtTo to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "lastEmployeeAnsweredToResidentAtTo" CASCADE;
--
-- Add field lastEmployeeAnsweredToResidentAtFrom to ticketchange
--
ALTER TABLE "TicketChange" DROP COLUMN "lastEmployeeAnsweredToResidentAtFrom" CASCADE;
--
-- Add field lastResidentCommentAt to ticket
--
ALTER TABLE "Ticket" DROP COLUMN "lastResidentCommentAt" CASCADE;
--
-- Add field lastEmployeeAnsweredToResidentAt to ticket
--
ALTER TABLE "Ticket" DROP COLUMN "lastEmployeeAnsweredToResidentAt" CASCADE;
--
-- Create model userticketcommentreadhistoryrecord
--
DROP TABLE "UserTicketCommentReadHistoryRecord" CASCADE;
--
-- Create model userticketcommentread
--
DROP TABLE "UserTicketCommentRead" CASCADE;
CREATE INDEX "TicketCommentFileHistoryRecord_history_id_2e8dc51c" ON "TicketCommentFileHistoryRecord" ("history_id");
ALTER TABLE "TicketCommentFile" ADD CONSTRAINT "TicketCommentFile_createdBy_99316846_fk_User_id" FOREIGN KEY ("createdBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "TicketCommentFile" ADD CONSTRAINT "TicketCommentFile_organization_6434badd_fk_Organization_id" FOREIGN KEY ("organization") REFERENCES "Organization" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "TicketCommentFile" ADD CONSTRAINT "TicketCommentFile_ticket_cb16229f_fk_Ticket_id" FOREIGN KEY ("ticket") REFERENCES "Ticket" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "TicketCommentFile" ADD CONSTRAINT "TicketCommentFile_ticketComment_bdcf221a_fk_TicketComment_id" FOREIGN KEY ("ticketComment") REFERENCES "TicketComment" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "TicketCommentFile" ADD CONSTRAINT "TicketCommentFile_updatedBy_3746e07c_fk_User_id" FOREIGN KEY ("updatedBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "TicketCommentFile_createdAt_bbfc5069" ON "TicketCommentFile" ("createdAt");
CREATE INDEX "TicketCommentFile_updatedAt_e338b7b0" ON "TicketCommentFile" ("updatedAt");
CREATE INDEX "TicketCommentFile_deletedAt_b5e2a68b" ON "TicketCommentFile" ("deletedAt");
CREATE INDEX "TicketCommentFile_createdBy_99316846" ON "TicketCommentFile" ("createdBy");
CREATE INDEX "TicketCommentFile_organization_6434badd" ON "TicketCommentFile" ("organization");
CREATE INDEX "TicketCommentFile_ticket_cb16229f" ON "TicketCommentFile" ("ticket");
CREATE INDEX "TicketCommentFile_ticketComment_bdcf221a" ON "TicketCommentFile" ("ticketComment");
CREATE INDEX "TicketCommentFile_updatedBy_3746e07c" ON "TicketCommentFile" ("updatedBy");
COMMIT;

    `)
}
