// auto generated by kmigrator
// KMIGRATOR:0333_auto_20231025_0444:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi41IG9uIDIwMjMtMTAtMjUgMDQ6NDQKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwMzMyX21hcmtldGl0ZW1maWxlaGlzdG9yeXJlY29yZF9tYXJrZXRpdGVtZmlsZScpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;    
    
    --
    -- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
    --
    SET statement_timeout = '1500s';
    
    --
    -- [CUSTOM] Update permissions for existed Contractor roles
    --
    UPDATE "OrganizationEmployeeRole"
    SET "canReadEmployees" = false,
        "canReadIncidents" = false,
        "canManageIncidents" = false
    WHERE name = 'employee.role.Contractor.name';
    
    --
    -- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
    --
    SET statement_timeout = '10s';
    
    COMMIT;
    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    
    `)
}
