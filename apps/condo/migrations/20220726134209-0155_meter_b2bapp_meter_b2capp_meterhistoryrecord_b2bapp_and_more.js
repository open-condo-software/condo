// auto generated by kmigrator
// KMIGRATOR:0155_meter_b2bapp_meter_b2capp_meterhistoryrecord_b2bapp_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMC4yIG9uIDIwMjItMDctMjYgMDg6NDIKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAxNTRfdGlja2V0ZXhwb3J0dGFza190aWNrZXRleHBvcnR0YXNraGlzdG9yeXJlY29yZCcpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbWV0ZXInLAogICAgICAgICAgICBuYW1lPSdiMmJBcHAnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRm9yZWlnbktleShibGFuaz1UcnVlLCBkYl9jb2x1bW49J2IyYkFwcCcsIG51bGw9VHJ1ZSwgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uU0VUX05VTEwsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS5iMmJhcHAnKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J21ldGVyJywKICAgICAgICAgICAgbmFtZT0nYjJjQXBwJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkZvcmVpZ25LZXkoYmxhbms9VHJ1ZSwgZGJfY29sdW1uPSdiMmNBcHAnLCBudWxsPVRydWUsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLlNFVF9OVUxMLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEuYjJjYXBwJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdtZXRlcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdiMmJBcHAnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVVVJREZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdtZXRlcmhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdiMmNBcHAnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVVVJREZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field b2bApp to meter
--
ALTER TABLE "Meter" ADD COLUMN IF NOT EXISTS "b2bApp" uuid NULL CONSTRAINT "Meter_b2bApp_3101a0e5_fk_B2BApp_id" REFERENCES "B2BApp"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Meter_b2bApp_3101a0e5_fk_B2BApp_id" IMMEDIATE;
--
-- Add field b2cApp to meter
--
ALTER TABLE "Meter" ADD COLUMN IF NOT EXISTS "b2cApp" uuid NULL CONSTRAINT "Meter_b2cApp_4fbac346_fk_B2CApp_id" REFERENCES "B2CApp"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Meter_b2cApp_4fbac346_fk_B2CApp_id" IMMEDIATE;
--
-- Add field b2bApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" ADD COLUMN IF NOT EXISTS "b2bApp" uuid NULL;
--
-- Add field b2cApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" ADD COLUMN IF NOT EXISTS "b2cApp" uuid NULL;
CREATE INDEX IF NOT EXISTS "Meter_b2bApp_3101a0e5" ON "Meter" ("b2bApp");
CREATE INDEX IF NOT EXISTS "Meter_b2cApp_4fbac346" ON "Meter" ("b2cApp");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field b2cApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" DROP COLUMN "b2cApp" CASCADE;
--
-- Add field b2bApp to meterhistoryrecord
--
ALTER TABLE "MeterHistoryRecord" DROP COLUMN "b2bApp" CASCADE;
--
-- Add field b2cApp to meter
--
ALTER TABLE "Meter" DROP COLUMN "b2cApp" CASCADE;
--
-- Add field b2bApp to meter
--
ALTER TABLE "Meter" DROP COLUMN "b2bApp" CASCADE;
COMMIT;

    `)
}
