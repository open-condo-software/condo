// auto generated by kmigrator
// KMIGRATOR:0184_auto_20221102_1402:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi45IG9uIDIwMjItMTEtMDIgMTQ6MDIKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwMTgxX3dlYmhvb2tfd2ViaG9va2hpc3RvcnlyZWNvcmRfYW5kX21vcmUnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0ndG9rZW5zZXQnLAojICAgICAgICAgICAgbmFtZT0nY3JlYXRlZEJ5JywKIyAgICAgICAgKSwKIyAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVGaWVsZCgKIyAgICAgICAgICAgIG1vZGVsX25hbWU9J3Rva2Vuc2V0JywKIyAgICAgICAgICAgIG5hbWU9J29yZ2FuaXphdGlvbicsCiMgICAgICAgICksCiMgICAgICAgIG1pZ3JhdGlvbnMuUmVtb3ZlRmllbGQoCiMgICAgICAgICAgICBtb2RlbF9uYW1lPSd0b2tlbnNldCcsCiMgICAgICAgICAgICBuYW1lPSd1cGRhdGVkQnknLAojICAgICAgICApLAojICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAojICAgICAgICAgICAgbW9kZWxfbmFtZT0ndG9rZW5zZXQnLAojICAgICAgICAgICAgbmFtZT0ndXNlcicsCiMgICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5EZWxldGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0ndG9rZW5zZXQnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5EZWxldGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0ndG9rZW5zZXRoaXN0b3J5cmVjb3JkJywKICAgICAgICApLAogICAgXQo=

// NOTE(antonal): Keep data for backward compatibility with old code, will keep querying the table during deployment
// Table will be removed manually later, see 'fix-database-migration-state.js' script
exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model tokenset
--
--DROP TABLE "TokenSet" CASCADE;
--
-- Delete model tokensethistoryrecord
--
--DROP TABLE "TokenSetHistoryRecord" CASCADE;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model tokensethistoryrecord
--
--CREATE TABLE "TokenSetHistoryRecord" ("dv" integer NULL, "sender" jsonb NULL, "user" uuid NULL, "organization" uuid NULL, "importRemoteSystem" text NULL, "accessToken" text NULL, "accessTokenExpiresAt" timestamp with time zone NULL, "refreshToken" text NULL, "refreshTokenExpiresAt" timestamp with time zone NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "createdBy" uuid NULL, "updatedBy" uuid NULL, "deletedAt" timestamp with time zone NULL, "newId" jsonb NULL, "history_date" timestamp with time zone NOT NULL, "history_action" varchar(50) NOT NULL, "history_id" uuid NOT NULL, "clientSecret" text NULL, "clientSecretExpiresAt" timestamp with time zone NULL);
--
-- Delete model tokenset
-- 
--CREATE TABLE "TokenSet" ("dv" integer NOT NULL, "sender" jsonb NOT NULL, "importRemoteSystem" text NOT NULL, "accessToken" text NOT NULL, "accessTokenExpiresAt" timestamp with time zone NOT NULL, "refreshToken" text NOT NULL, "refreshTokenExpiresAt" timestamp with time zone NOT NULL, "id" uuid NOT NULL PRIMARY KEY, "v" integer NOT NULL, "createdAt" timestamp with time zone NULL, "updatedAt" timestamp with time zone NULL, "deletedAt" timestamp with time zone NULL, "newId" uuid NULL, "createdBy" uuid NULL, "organization" uuid NOT NULL, "updatedBy" uuid NULL, "user" uuid NOT NULL, "clientSecret" text NULL, "clientSecretExpiresAt" timestamp with time zone NULL);
--CREATE INDEX "TokenSetHistoryRecord_history_id_32e148aa" ON "TokenSetHistoryRecord" ("history_id");
--ALTER TABLE "TokenSet" ADD CONSTRAINT "TokenSet_createdBy_930e7843_fk_User_id" FOREIGN KEY ("createdBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
--ALTER TABLE "TokenSet" ADD CONSTRAINT "TokenSet_organization_74ef99f6_fk_Organization_id" FOREIGN KEY ("organization") REFERENCES "Organization" ("id") DEFERRABLE INITIALLY DEFERRED;
--ALTER TABLE "TokenSet" ADD CONSTRAINT "TokenSet_updatedBy_175afec4_fk_User_id" FOREIGN KEY ("updatedBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
--ALTER TABLE "TokenSet" ADD CONSTRAINT "TokenSet_user_d1aacb66_fk_User_id" FOREIGN KEY ("user") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
--CREATE INDEX "TokenSet_createdAt_a6b55d16" ON "TokenSet" ("createdAt");
--CREATE INDEX "TokenSet_updatedAt_cd631a7d" ON "TokenSet" ("updatedAt");
--CREATE INDEX "TokenSet_deletedAt_b792fe13" ON "TokenSet" ("deletedAt");
--CREATE INDEX "TokenSet_createdBy_930e7843" ON "TokenSet" ("createdBy");
--CREATE INDEX "TokenSet_organization_74ef99f6" ON "TokenSet" ("organization");
--CREATE INDEX "TokenSet_updatedBy_175afec4" ON "TokenSet" ("updatedBy");
--CREATE INDEX "TokenSet_user_d1aacb66" ON "TokenSet" ("user");
COMMIT;

    `)
}
