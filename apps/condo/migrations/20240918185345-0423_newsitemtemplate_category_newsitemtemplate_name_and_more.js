// auto generated by kmigrator
// KMIGRATOR:0423_newsitemtemplate_category_newsitemtemplate_name_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDUuMC43IG9uIDIwMjQtMDktMTggMTQ6MzgKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzA0MjJfbWV0ZXJyZWFkaW5nX2JpbGxpbmdzdGF0dXNfYW5kX21vcmUnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J25ld3NpdGVtdGVtcGxhdGUnLAogICAgICAgICAgICBuYW1lPSdjYXRlZ29yeScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5DaGFyRmllbGQoYmxhbms9VHJ1ZSwgY2hvaWNlcz1bKCd3YXRlcicsICd3YXRlcicpLCAoJ2hlYXRpbmcnLCAnaGVhdGluZycpLCAoJ2VsZWN0cmljaXR5JywgJ2VsZWN0cmljaXR5JyksICgnc3dpY2hib2FyZEFuZFdhdGVyJywgJ3N3aWNoYm9hcmRBbmRXYXRlcicpLCAoJ3N3aWNoYm9hcmQnLCAnc3dpY2hib2FyZCcpLCAoJ2xpZ3RoJywgJ2xpZ3RoJyksICgnZWxldmF0b3JzJywgJ2VsZXZhdG9ycycpLCAoJ3RlbGVwaG9uZScsICd0ZWxlcGhvbmUnKSwgKCdtZXRlcnMnLCAnbWV0ZXJzJyksICgnZ2FzJywgJ2dhcycpLCAoJ2ludGVyY29tJywgJ2ludGVyY29tJyksICgnY2xlYW5pbmcnLCAnY2xlYW5pbmcnKSwgKCdzbm93JywgJ3Nub3cnKSwgKCdvdGhlcicsICdvdGhlcicpXSwgbWF4X2xlbmd0aD01MCwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J25ld3NpdGVtdGVtcGxhdGUnLAogICAgICAgICAgICBuYW1lPSduYW1lJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChkZWZhdWx0PSdUZW1wJyksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSduZXdzaXRlbXRlbXBsYXRlaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J2NhdGVnb3J5JywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nbmV3c2l0ZW10ZW1wbGF0ZWhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSduYW1lJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field category to newsitemtemplate
--
ALTER TABLE "NewsItemTemplate" ADD COLUMN "category" varchar(50) NULL;
--
-- Add field name to newsitemtemplate
--
ALTER TABLE "NewsItemTemplate" ADD COLUMN "name" text DEFAULT 'Temp' NOT NULL;
ALTER TABLE "NewsItemTemplate" ALTER COLUMN "name" DROP DEFAULT;
UPDATE "NewsItemTemplate" SET name = title WHERE name = 'Temp';
--
-- Add field category to newsitemtemplatehistoryrecord
--
ALTER TABLE "NewsItemTemplateHistoryRecord" ADD COLUMN "category" text NULL;
--
-- Add field name to newsitemtemplatehistoryrecord
--
ALTER TABLE "NewsItemTemplateHistoryRecord" ADD COLUMN "name" text NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field name to newsitemtemplatehistoryrecord
--
ALTER TABLE "NewsItemTemplateHistoryRecord" DROP COLUMN "name" CASCADE;
--
-- Add field category to newsitemtemplatehistoryrecord
--
ALTER TABLE "NewsItemTemplateHistoryRecord" DROP COLUMN "category" CASCADE;
--
-- Add field name to newsitemtemplate
--
ALTER TABLE "NewsItemTemplate" DROP COLUMN "name" CASCADE;
--
-- Add field category to newsitemtemplate
--
ALTER TABLE "NewsItemTemplate" DROP COLUMN "category" CASCADE;
COMMIT;

    `)
}
