// auto generated by kmigrator
// KMIGRATOR:0476_executionaiflowtask_cleancontext_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDUuMS40IG9uIDIwMjUtMDctMjMgMTQ6MDUKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzA0NzVfY29uZmlybWVtYWlsYWN0aW9uX2NvbmZpcm1lbWFpbGFjdGlvbmhpc3RvcnlyZWNvcmQnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2V4ZWN1dGlvbmFpZmxvd3Rhc2snLAogICAgICAgICAgICBuYW1lPSdjbGVhbkNvbnRleHQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGRlZmF1bHQ9e30pLAogICAgICAgICAgICBwcmVzZXJ2ZV9kZWZhdWx0PUZhbHNlLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nZXhlY3V0aW9uYWlmbG93dGFza2hpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdjbGVhbkNvbnRleHQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field cleanContext to executionaiflowtask
--
ALTER TABLE "ExecutionAIFlowTask" ADD COLUMN "cleanContext" jsonb DEFAULT '{}'::jsonb NOT NULL;
ALTER TABLE "ExecutionAIFlowTask" ALTER COLUMN "cleanContext" DROP DEFAULT;
--
-- Add field cleanContext to executionaiflowtaskhistoryrecord
--
ALTER TABLE "ExecutionAIFlowTaskHistoryRecord" ADD COLUMN "cleanContext" jsonb NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field cleanContext to executionaiflowtaskhistoryrecord
--
ALTER TABLE "ExecutionAIFlowTaskHistoryRecord" DROP COLUMN "cleanContext" CASCADE;
--
-- Add field cleanContext to executionaiflowtask
--
ALTER TABLE "ExecutionAIFlowTask" DROP COLUMN "cleanContext" CASCADE;
COMMIT;

    `)
}
