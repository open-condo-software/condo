// auto generated by kmigrator
// KMIGRATOR:0391_auto_20240503_0443:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMSBvbiAyMDI0LTA1LTAzIDA0OjQzCgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucwoKCmNsYXNzIE1pZ3JhdGlvbihtaWdyYXRpb25zLk1pZ3JhdGlvbik6CgogICAgZGVwZW5kZW5jaWVzID0gWwogICAgICAgICgnX2RqYW5nb19zY2hlbWEnLCAnMDM5MF9hdXRvXzIwMjQwNDIzXzA1NDknKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
    --
    -- [CUSTOM] Update 'fields' of MeterReadingFilterTemplate: controlReadingDate -> controlReadingsDate
    --

    UPDATE "MeterReadingFilterTemplate"
    SET "fields" = "fields" - 'controlReadingDate' || jsonb_build_object(
        'controlReadingsDate', "fields" -> 'controlReadingDate'
    ) WHERE "fields" IS NOT NULL
    AND "fields" -> 'controlReadingDate' IS NOT NULL
    AND "deletedAt" IS NULL;
    
    COMMIT;
    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
    --
    -- [CUSTOM] Update 'fields' of MeterReadingFilterTemplate: controlReadingsDate -> controlReadingDate
    --

    UPDATE "MeterReadingFilterTemplate"
    SET "fields" = "fields" - 'controlReadingsDate' || jsonb_build_object(
        'controlReadingDate', "fields" -> 'controlReadingsDate'
    ) WHERE "fields" IS NOT NULL
    AND "fields" -> 'controlReadingsDate' IS NOT NULL
    AND "deletedAt" IS NULL;
    
    COMMIT;
    `)
}
