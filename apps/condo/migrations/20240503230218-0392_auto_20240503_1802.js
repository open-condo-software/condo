// auto generated by kmigrator
// KMIGRATOR:0392_auto_20240503_1802:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMSBvbiAyMDI0LTA1LTAzIDE4OjAyCgppbXBvcnQgZGphbmdvLmNvbnRyaWIucG9zdGdyZXMuaW5kZXhlcwpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucwoKCmNsYXNzIE1pZ3JhdGlvbihtaWdyYXRpb25zLk1pZ3JhdGlvbik6CgogICAgZGVwZW5kZW5jaWVzID0gWwogICAgICAgICgnX2RqYW5nb19zY2hlbWEnLCAnMDM5MV9hdXRvXzIwMjQwNTAzXzA0NDMnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuQWRkSW5kZXgoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J21lc3NhZ2UnLAogICAgICAgICAgICBpbmRleD1kamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5pbmRleGVzLkJUcmVlSW5kZXgoZmllbGRzPVsndW5pcUtleScsICd0eXBlJ10sIG5hbWU9J21lc3NhZ2VfdW5pcUtleV90eXBlJyksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
    --
    -- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
    --
    SET statement_timeout = '1500s';
    --
    -- Create index message_uniqKey_type on field(s) uniqKey, type of model message
    --
    CREATE INDEX IF NOT EXISTS "message_uniqKey_type" ON "Message" USING btree ("uniqKey", "type");
    --
    -- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
    --
    SET statement_timeout = '10s';

    COMMIT;
    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
    --
    -- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
    --
    SET statement_timeout = '1500s';
    --
    -- Create index message_uniqKey_type on field(s) uniqKey, type of model message
    --
    DROP INDEX IF EXISTS "message_uniqKey_type";
    --
    -- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
    --
    SET statement_timeout = '10s';

    COMMIT;

    `)
}
