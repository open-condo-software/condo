// auto generated by kmigrator
// KMIGRATOR:0393_auto_20240504_1040:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMSBvbiAyMDI0LTA1LTA0IDEwOjQwCgppbXBvcnQgZGphbmdvLmNvbnRyaWIucG9zdGdyZXMuaW5kZXhlcwpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucwoKCmNsYXNzIE1pZ3JhdGlvbihtaWdyYXRpb25zLk1pZ3JhdGlvbik6CgogICAgZGVwZW5kZW5jaWVzID0gWwogICAgICAgICgnX2RqYW5nb19zY2hlbWEnLCAnMDM5Ml9iaWxsaW5naW50ZWdyYXRpb25fY2hlY2thY2NvdW50bnVtYmVydXJsX2FuZF9tb3JlJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEluZGV4KAogICAgICAgICAgICBtb2RlbF9uYW1lPSdtZXNzYWdlJywKICAgICAgICAgICAgaW5kZXg9ZGphbmdvLmNvbnRyaWIucG9zdGdyZXMuaW5kZXhlcy5CVHJlZUluZGV4KGZpZWxkcz1bJ3VuaXFLZXknLCAndHlwZSddLCBuYW1lPSdtZXNzYWdlX3VuaXFLZXlfdHlwZScpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
    --
    -- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
    --
    SET statement_timeout = '1500s';
    --
    -- Create index message_uniqKey_type on field(s) uniqKey, type of model message
    --
    CREATE INDEX IF NOT EXISTS "message_uniqKey_type" ON "Message" USING btree ("uniqKey", "type");
    --
    -- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
    --
    SET statement_timeout = '10s';
    COMMIT;
    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
    --
    -- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
    --
    SET statement_timeout = '1500s';
    --
    -- Create index message_uniqKey_type on field(s) uniqKey, type of model message
    --
    DROP INDEX IF EXISTS "message_uniqKey_type";
    --
    -- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
    --
    SET statement_timeout = '10s';
    COMMIT;
    `)
}
