// auto generated by kmigrator
// KMIGRATOR:0032_auto_20210801_1555:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi41IG9uIDIwMjEtMDgtMDEgMTU6NTUKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwMzFfb3JnYW5pemF0aW9ubGlua19vcmdhbml6YXRpb25saW5raGlzdG9yeXJlY29yZCcpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nb3JnYW5pemF0aW9uJywKICAgICAgICAgICAgbmFtZT0naW1wb3J0SWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdvcmdhbml6YXRpb24nLAogICAgICAgICAgICBuYW1lPSdpbXBvcnRSZW1vdGVTeXN0ZW0nLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdvcmdhbml6YXRpb25oaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naW1wb3J0SWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdvcmdhbml6YXRpb25oaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naW1wb3J0UmVtb3RlU3lzdGVtJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndXNlcicsCiAgICAgICAgICAgIG5hbWU9J2ltcG9ydFJlbW90ZVN5c3RlbScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3VzZXJoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naW1wb3J0UmVtb3RlU3lzdGVtJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd1c2VyJywKICAgICAgICAgICAgbmFtZT0naW1wb3J0SWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field importId to organization
--
ALTER TABLE "Organization" ADD COLUMN "importId" text NULL;
--
-- Add field importRemoteSystem to organization
--
ALTER TABLE "Organization" ADD COLUMN "importRemoteSystem" text NULL;
--
-- Add field importId to organizationhistoryrecord
--
ALTER TABLE "OrganizationHistoryRecord" ADD COLUMN "importId" text NULL;
--
-- Add field importRemoteSystem to organizationhistoryrecord
--
ALTER TABLE "OrganizationHistoryRecord" ADD COLUMN "importRemoteSystem" text NULL;
--
-- Add field importRemoteSystem to user
--
ALTER TABLE "User" ADD COLUMN "importRemoteSystem" text NULL;
--
-- Add field importRemoteSystem to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" ADD COLUMN "importRemoteSystem" text NULL;
--
-- Alter field importId on user
--
ALTER TABLE "User" DROP CONSTRAINT "User_importId_key";
DROP INDEX IF EXISTS "User_importId_1ba44fc8_like";
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field importId on user
--
ALTER TABLE "User" ADD CONSTRAINT "User_importId_1ba44fc8_uniq" UNIQUE ("importId");
CREATE INDEX "User_importId_1ba44fc8_like" ON "User" ("importId" text_pattern_ops);
--
-- Add field importRemoteSystem to userhistoryrecord
--
ALTER TABLE "UserHistoryRecord" DROP COLUMN "importRemoteSystem" CASCADE;
--
-- Add field importRemoteSystem to user
--
ALTER TABLE "User" DROP COLUMN "importRemoteSystem" CASCADE;
--
-- Add field importRemoteSystem to organizationhistoryrecord
--
ALTER TABLE "OrganizationHistoryRecord" DROP COLUMN "importRemoteSystem" CASCADE;
--
-- Add field importId to organizationhistoryrecord
--
ALTER TABLE "OrganizationHistoryRecord" DROP COLUMN "importId" CASCADE;
--
-- Add field importRemoteSystem to organization
--
ALTER TABLE "Organization" DROP COLUMN "importRemoteSystem" CASCADE;
--
-- Add field importId to organization
--
ALTER TABLE "Organization" DROP COLUMN "importId" CASCADE;
COMMIT;

    `)
}
