// auto generated by kmigrator
// KMIGRATOR:0030_auto_20210728_1223:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi40IG9uIDIwMjEtMDctMjggMTI6MjMKCmltcG9ydCBkamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5maWVsZHMuanNvbmIKZnJvbSBkamFuZ28uZGIgaW1wb3J0IG1pZ3JhdGlvbnMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwMjlfYXV0b18yMDIxMDcyMl8xMDUyJyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLlJlbmFtZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiaWxsaW5nb3JnYW5pemF0aW9uJywKICAgICAgICAgICAgb2xkX25hbWU9J2NoZWNrTnVtYmVyJywKICAgICAgICAgICAgbmV3X25hbWU9J2JhbmtBY2NvdW50JywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVuYW1lRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2JpbGxpbmdvcmdhbml6YXRpb25oaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgb2xkX25hbWU9J2NoZWNrTnVtYmVyJywKICAgICAgICAgICAgbmV3X25hbWU9J2JhbmtBY2NvdW50JywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYmlsbGluZ3JlY2VpcHQnLAogICAgICAgICAgICBuYW1lPSdyZWNpcGllbnQnLAogICAgICAgICAgICBmaWVsZD1kamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5maWVsZHMuanNvbmIuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2JpbGxpbmdyZWNlaXB0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3JlY2lwaWVudCcsCiAgICAgICAgICAgIGZpZWxkPWRqYW5nby5jb250cmliLnBvc3RncmVzLmZpZWxkcy5qc29uYi5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Rename field checkNumber on billingorganization to bankAccount
--
ALTER TABLE "BillingOrganization" RENAME COLUMN "checkNumber" TO "bankAccount";
--
-- Rename field checkNumber on billingorganizationhistoryrecord to bankAccount
--
ALTER TABLE "BillingOrganizationHistoryRecord" RENAME COLUMN "checkNumber" TO "bankAccount";
--
-- Alter field recipient on billingreceipt
--
SET CONSTRAINTS "BillingReceipt_recipient_585a5f77_fk_BillingOrganization_id" IMMEDIATE; ALTER TABLE "BillingReceipt" DROP CONSTRAINT "BillingReceipt_recipient_585a5f77_fk_BillingOrganization_id";
DROP INDEX IF EXISTS "BillingReceipt_recipient_585a5f77";
ALTER TABLE "BillingReceipt" ALTER COLUMN "recipient" TYPE jsonb USING "recipient"::jsonb;
--
-- Alter field recipient on billingreceipthistoryrecord
--
ALTER TABLE "BillingReceiptHistoryRecord" ALTER COLUMN "recipient" TYPE jsonb USING "recipient"::jsonb;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field recipient on billingreceipthistoryrecord
--
ALTER TABLE "BillingReceiptHistoryRecord" ALTER COLUMN "recipient" TYPE uuid USING "recipient"::uuid;
--
-- Alter field recipient on billingreceipt
--
ALTER TABLE "BillingReceipt" ALTER COLUMN "recipient" TYPE uuid USING "recipient"::uuid;
CREATE INDEX "BillingReceipt_recipient_585a5f77" ON "BillingReceipt" ("recipient");
ALTER TABLE "BillingReceipt" ADD CONSTRAINT "BillingReceipt_recipient_585a5f77_fk_BillingOrganization_id" FOREIGN KEY ("recipient") REFERENCES "BillingOrganization" ("id") DEFERRABLE INITIALLY DEFERRED;
--
-- Rename field checkNumber on billingorganizationhistoryrecord to bankAccount
--
ALTER TABLE "BillingOrganizationHistoryRecord" RENAME COLUMN "bankAccount" TO "checkNumber";
--
-- Rename field checkNumber on billingorganization to bankAccount
--
ALTER TABLE "BillingOrganization" RENAME COLUMN "bankAccount" TO "checkNumber";
COMMIT;

    `)
}
