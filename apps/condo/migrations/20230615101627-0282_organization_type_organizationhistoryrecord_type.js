// auto generated by kmigrator
// KMIGRATOR:0282_organization_type_organizationhistoryrecord_type:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMS41IG9uIDIwMjMtMDYtMTUgMDU6MTcKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAyODFfcmVtb3ZlX25vdGlmaWNhdGlvbnVzZXJzZXR0aW5nX25vdGlmaWNhdGlvbnVzZXJzZXR0aW5nX3VuaXF1ZV91c2VyX21lc3NhZ2V0eXBlX21lc3NhZ2V0cmFuc3BvcnRfYW5kXycpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nb3JnYW5pemF0aW9uJywKICAgICAgICAgICAgbmFtZT0ndHlwZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoZGVmYXVsdD0nTUFOQUdJTkdfQ09NUEFOWScpLAogICAgICAgICAgICBwcmVzZXJ2ZV9kZWZhdWx0PUZhbHNlLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nb3JnYW5pemF0aW9uaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3R5cGUnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field type to organization
--
ALTER TABLE "Organization" ADD COLUMN "type" text DEFAULT 'MANAGING_COMPANY' NOT NULL;
ALTER TABLE "Organization" ALTER COLUMN "type" DROP DEFAULT;
--
-- Add field type to organizationhistoryrecord
--
ALTER TABLE "OrganizationHistoryRecord" ADD COLUMN "type" text NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field type to organizationhistoryrecord
--
ALTER TABLE "OrganizationHistoryRecord" DROP COLUMN "type" CASCADE;
--
-- Add field type to organization
--
ALTER TABLE "Organization" DROP COLUMN "type" CASCADE;
COMMIT;

    `)
}
