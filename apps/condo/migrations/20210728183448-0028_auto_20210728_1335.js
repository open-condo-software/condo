// auto generated by kmigrator
// KMIGRATOR:0028_auto_20210728_1335:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi40IG9uIDIwMjEtMDctMjggMTM6MzUKCmltcG9ydCBkamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5maWVsZHMuanNvbmIKZnJvbSBkamFuZ28uZGIgaW1wb3J0IG1pZ3JhdGlvbnMsIG1vZGVscwoKCmNsYXNzIE1pZ3JhdGlvbihtaWdyYXRpb25zLk1pZ3JhdGlvbik6CgogICAgZGVwZW5kZW5jaWVzID0gWwogICAgICAgICgnX2RqYW5nb19zY2hlbWEnLCAnMDAyN19hdXRvXzIwMjEwNzE5XzA1MzYnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuUmVuYW1lRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2JpbGxpbmdyZWNlaXB0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG9sZF9uYW1lPSdtZXRhJywKICAgICAgICAgICAgbmV3X25hbWU9J3RvUGF5RGV0YWlscycsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiaWxsaW5ncmVjZWlwdCcsCiAgICAgICAgICAgIG5hbWU9J21ldGEnLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYmlsbGluZ3JlY2VpcHQnLAogICAgICAgICAgICBuYW1lPSdwcmludGFibGVOdW1iZXInLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiaWxsaW5ncmVjZWlwdCcsCiAgICAgICAgICAgIG5hbWU9J3JlY2lwaWVudCcsCiAgICAgICAgICAgIGZpZWxkPWRqYW5nby5jb250cmliLnBvc3RncmVzLmZpZWxkcy5qc29uYi5KU09ORmllbGQoZGVmYXVsdD17fSksCiAgICAgICAgICAgIHByZXNlcnZlX2RlZmF1bHQ9RmFsc2UsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdiaWxsaW5ncmVjZWlwdCcsCiAgICAgICAgICAgIG5hbWU9J3RvUGF5RGV0YWlscycsCiAgICAgICAgICAgIGZpZWxkPWRqYW5nby5jb250cmliLnBvc3RncmVzLmZpZWxkcy5qc29uYi5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2JpbGxpbmdyZWNlaXB0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3ByaW50YWJsZU51bWJlcicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J2JpbGxpbmdyZWNlaXB0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3JlY2lwaWVudCcsCiAgICAgICAgICAgIGZpZWxkPWRqYW5nby5jb250cmliLnBvc3RncmVzLmZpZWxkcy5qc29uYi5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0nYmlsbGluZ3JlY2VpcHQnLAogICAgICAgICAgICBuYW1lPSdzZXJ2aWNlcycsCiAgICAgICAgICAgIGZpZWxkPWRqYW5nby5jb250cmliLnBvc3RncmVzLmZpZWxkcy5qc29uYi5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Rename field meta on billingreceipthistoryrecord to toPayDetails
--
ALTER TABLE "BillingReceiptHistoryRecord" RENAME COLUMN "meta" TO "toPayDetails";
--
-- Remove field meta from billingreceipt
--
ALTER TABLE "BillingReceipt" DROP COLUMN "meta" CASCADE;
--
-- Add field printableNumber to billingreceipt
--
ALTER TABLE "BillingReceipt" ADD COLUMN "printableNumber" text NULL;
--
-- Add field recipient to billingreceipt
--
ALTER TABLE "BillingReceipt" ADD COLUMN "recipient" jsonb DEFAULT '{}' NOT NULL;
ALTER TABLE "BillingReceipt" ALTER COLUMN "recipient" DROP DEFAULT;
--
-- Add field toPayDetails to billingreceipt
--
ALTER TABLE "BillingReceipt" ADD COLUMN "toPayDetails" jsonb NULL;
--
-- Add field printableNumber to billingreceipthistoryrecord
--
ALTER TABLE "BillingReceiptHistoryRecord" ADD COLUMN "printableNumber" text NULL;
--
-- Add field recipient to billingreceipthistoryrecord
--
ALTER TABLE "BillingReceiptHistoryRecord" ADD COLUMN "recipient" jsonb NULL;
--
-- Alter field services on billingreceipt
--
ALTER TABLE "BillingReceipt" ALTER COLUMN "services" DROP NOT NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field services on billingreceipt
--
ALTER TABLE "BillingReceipt" ALTER COLUMN "services" SET NOT NULL;
--
-- Add field recipient to billingreceipthistoryrecord
--
ALTER TABLE "BillingReceiptHistoryRecord" DROP COLUMN "recipient" CASCADE;
--
-- Add field printableNumber to billingreceipthistoryrecord
--
ALTER TABLE "BillingReceiptHistoryRecord" DROP COLUMN "printableNumber" CASCADE;
--
-- Add field toPayDetails to billingreceipt
--
ALTER TABLE "BillingReceipt" DROP COLUMN "toPayDetails" CASCADE;
--
-- Add field recipient to billingreceipt
--
ALTER TABLE "BillingReceipt" DROP COLUMN "recipient" CASCADE;
--
-- Add field printableNumber to billingreceipt
--
ALTER TABLE "BillingReceipt" DROP COLUMN "printableNumber" CASCADE;
--
-- Remove field meta from billingreceipt
--
ALTER TABLE "BillingReceipt" ADD COLUMN "meta" jsonb NOT NULL;
--
-- Rename field meta on billingreceipthistoryrecord to toPayDetails
--
ALTER TABLE "BillingReceiptHistoryRecord" RENAME COLUMN "toPayDetails" TO "meta";
COMMIT;

    `)
}
