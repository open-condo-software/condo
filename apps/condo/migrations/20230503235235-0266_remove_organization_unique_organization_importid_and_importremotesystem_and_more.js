// auto generated by kmigrator
// KMIGRATOR:0266_remove_organization_unique_organization_importid_and_importremotesystem_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMSBvbiAyMDIzLTA1LTAzIDE4OjUyCgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucywgbW9kZWxzCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwMjY1X25ld3NpdGVtX2lzcHVibGlzaGVkX25ld3NpdGVtX3NlbnRhdF9hbmRfbW9yZScpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5SZW1vdmVDb25zdHJhaW50KAogICAgICAgICAgICBtb2RlbF9uYW1lPSdvcmdhbml6YXRpb24nLAogICAgICAgICAgICBuYW1lPSd1bmlxdWVfb3JnYW5pemF0aW9uX2ltcG9ydGlkX2FuZF9pbXBvcnRyZW1vdGVzeXN0ZW0nLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRDb25zdHJhaW50KAogICAgICAgICAgICBtb2RlbF9uYW1lPSdvcmdhbml6YXRpb24nLAogICAgICAgICAgICBjb25zdHJhaW50PW1vZGVscy5VbmlxdWVDb25zdHJhaW50KGNvbmRpdGlvbj1tb2RlbHMuUSgoJ2RlbGV0ZWRBdF9faXNudWxsJywgVHJ1ZSkpLCBmaWVsZHM9KCdpbXBvcnRJZCcsICdpbXBvcnRSZW1vdGVTeXN0ZW0nKSwgbmFtZT0ndW5pcXVlX29yZ2FuaXphdGlvbl9pbXBvcnRpZF9hbmRfaW1wb3J0cmVtb3Rlc3lzdGVtJyksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Remove constraint unique_organization_importid_and_importremotesystem from model organization
--
ALTER TABLE "Organization" DROP CONSTRAINT "unique_organization_importid_and_importremotesystem";
--
-- Create constraint unique_organization_importid_and_importremotesystem on model organization
--
CREATE UNIQUE INDEX "unique_organization_importid_and_importremotesystem" ON "Organization" ("importId", "importRemoteSystem") WHERE "deletedAt" IS NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create constraint unique_organization_importid_and_importremotesystem on model organization
--
DROP INDEX IF EXISTS "unique_organization_importid_and_importremotesystem";
--
-- Remove constraint unique_organization_importid_and_importremotesystem from model organization
--
ALTER TABLE "Organization" ADD CONSTRAINT "unique_organization_importid_and_importremotesystem" UNIQUE ("importId", "importRemoteSystem");
COMMIT;

    `)
}
