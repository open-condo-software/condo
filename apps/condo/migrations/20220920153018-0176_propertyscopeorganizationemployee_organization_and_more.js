// auto generated by kmigrator
// KMIGRATOR:0176_propertyscopeorganizationemployee_organization_and_more:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDQuMSBvbiAyMDIyLTA5LTIwIDEwOjMwCgpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbWlncmF0aW9ucywgbW9kZWxzCmltcG9ydCBkamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwMTc1X3Byb3BlcnR5c2NvcGVvcmdhbml6YXRpb25lbXBsb3llZWhpc3RvcnlyZWNvcmRfYW5kX21vcmUnKSwKICAgIF0KCiAgICBvcGVyYXRpb25zID0gWwogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Byb3BlcnR5c2NvcGVvcmdhbml6YXRpb25lbXBsb3llZScsCiAgICAgICAgICAgIG5hbWU9J29yZ2FuaXphdGlvbicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0nb3JnYW5pemF0aW9uJywgbnVsbD1UcnVlLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5TRVRfTlVMTCwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLm9yZ2FuaXphdGlvbicpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ncHJvcGVydHlzY29wZW9yZ2FuaXphdGlvbmVtcGxveWVlaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J29yZ2FuaXphdGlvbicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5VVUlERmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Byb3BlcnR5c2NvcGVwcm9wZXJ0eScsCiAgICAgICAgICAgIG5hbWU9J29yZ2FuaXphdGlvbicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0nb3JnYW5pemF0aW9uJywgbnVsbD1UcnVlLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5TRVRfTlVMTCwgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLm9yZ2FuaXphdGlvbicpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BZGRGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ncHJvcGVydHlzY29wZXByb3BlcnR5aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J29yZ2FuaXphdGlvbicsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5VVUlERmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkQ29uc3RyYWludCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ncHJvcGVydHlzY29wZW9yZ2FuaXphdGlvbmVtcGxveWVlJywKICAgICAgICAgICAgY29uc3RyYWludD1tb2RlbHMuVW5pcXVlQ29uc3RyYWludChjb25kaXRpb249bW9kZWxzLlEoKCdkZWxldGVkQXRfX2lzbnVsbCcsIFRydWUpKSwgZmllbGRzPSgncHJvcGVydHlTY29wZScsICdlbXBsb3llZScpLCBuYW1lPSdwcm9wZXJ0eV9zY29wZV9vcmdhbml6YXRpb25fZW1wbG95ZWVfdW5pcXVlX3Byb3BlcnR5U2NvcGVfYW5kX2VtcGxveWVlJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZENvbnN0cmFpbnQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Byb3BlcnR5c2NvcGVwcm9wZXJ0eScsCiAgICAgICAgICAgIGNvbnN0cmFpbnQ9bW9kZWxzLlVuaXF1ZUNvbnN0cmFpbnQoY29uZGl0aW9uPW1vZGVscy5RKCgnZGVsZXRlZEF0X19pc251bGwnLCBUcnVlKSksIGZpZWxkcz0oJ3Byb3BlcnR5U2NvcGUnLCAncHJvcGVydHknKSwgbmFtZT0ncHJvcGVydHlfc2NvcGVfcHJvcGVydHlfdW5pcXVlX3Byb3BlcnR5U2NvcGVfYW5kX3Byb3BlcnR5JyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZENvbnN0cmFpbnQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3NwZWNpYWxpemF0aW9uc2NvcGUnLAogICAgICAgICAgICBjb25zdHJhaW50PW1vZGVscy5VbmlxdWVDb25zdHJhaW50KGNvbmRpdGlvbj1tb2RlbHMuUSgoJ2RlbGV0ZWRBdF9faXNudWxsJywgVHJ1ZSkpLCBmaWVsZHM9KCdlbXBsb3llZScsICdzcGVjaWFsaXphdGlvbicpLCBuYW1lPSdzcGVjaWFsaXphdGlvbl9zY29wZV91bmlxdWVfZW1wbG95ZWVfYW5kX3NwZWNpYWxpemF0aW9uJyksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field organization to propertyscopeorganizationemployee
--
ALTER TABLE "PropertyScopeOrganizationEmployee" ADD COLUMN "organization" uuid NULL CONSTRAINT "PropertyScopeOrganiz_organization_3890cfae_fk_Organizat" REFERENCES "Organization"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "PropertyScopeOrganiz_organization_3890cfae_fk_Organizat" IMMEDIATE;
--
-- Add field organization to propertyscopeorganizationemployeehistoryrecord
--
ALTER TABLE "PropertyScopeOrganizationEmployeeHistoryRecord" ADD COLUMN "organization" uuid NULL;
--
-- Add field organization to propertyscopeproperty
--
ALTER TABLE "PropertyScopeProperty" ADD COLUMN "organization" uuid NULL CONSTRAINT "PropertyScopeProperty_organization_36e7ef31_fk_Organization_id" REFERENCES "Organization"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "PropertyScopeProperty_organization_36e7ef31_fk_Organization_id" IMMEDIATE;
--
-- Add field organization to propertyscopepropertyhistoryrecord
--
ALTER TABLE "PropertyScopePropertyHistoryRecord" ADD COLUMN "organization" uuid NULL;
--
-- Create constraint property_scope_organization_employee_unique_propertyScope_and_employee on model propertyscopeorganizationemployee
--
CREATE UNIQUE INDEX "property_scope_organization_employee_unique_propertyScope_and_employee" ON "PropertyScopeOrganizationEmployee" ("propertyScope", "employee") WHERE "deletedAt" IS NULL;
--
-- Create constraint property_scope_property_unique_propertyScope_and_property on model propertyscopeproperty
--
CREATE UNIQUE INDEX "property_scope_property_unique_propertyScope_and_property" ON "PropertyScopeProperty" ("propertyScope", "property") WHERE "deletedAt" IS NULL;
--
-- Create constraint specialization_scope_unique_employee_and_specialization on model specializationscope
--
CREATE UNIQUE INDEX "specialization_scope_unique_employee_and_specialization" ON "SpecializationScope" ("employee", "specialization") WHERE "deletedAt" IS NULL;
CREATE INDEX "PropertyScopeOrganizationEmployee_organization_3890cfae" ON "PropertyScopeOrganizationEmployee" ("organization");
CREATE INDEX "PropertyScopeProperty_organization_36e7ef31" ON "PropertyScopeProperty" ("organization");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create constraint specialization_scope_unique_employee_and_specialization on model specializationscope
--
DROP INDEX IF EXISTS "specialization_scope_unique_employee_and_specialization";
--
-- Create constraint property_scope_property_unique_propertyScope_and_property on model propertyscopeproperty
--
DROP INDEX IF EXISTS "property_scope_property_unique_propertyScope_and_property";
--
-- Create constraint property_scope_organization_employee_unique_propertyScope_and_employee on model propertyscopeorganizationemployee
--
DROP INDEX IF EXISTS "property_scope_organization_employee_unique_propertyScope_and_employee";
--
-- Add field organization to propertyscopepropertyhistoryrecord
--
ALTER TABLE "PropertyScopePropertyHistoryRecord" DROP COLUMN "organization" CASCADE;
--
-- Add field organization to propertyscopeproperty
--
ALTER TABLE "PropertyScopeProperty" DROP COLUMN "organization" CASCADE;
--
-- Add field organization to propertyscopeorganizationemployeehistoryrecord
--
ALTER TABLE "PropertyScopeOrganizationEmployeeHistoryRecord" DROP COLUMN "organization" CASCADE;
--
-- Add field organization to propertyscopeorganizationemployee
--
ALTER TABLE "PropertyScopeOrganizationEmployee" DROP COLUMN "organization" CASCADE;
COMMIT;

    `)
}
