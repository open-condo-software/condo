// auto generated by kmigrator
// KMIGRATOR:0509_auto_20260204_1220:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMi41IG9uIDIwMjYtMDItMDQgMTI6MjAKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzA1MDhfYXV0b18yMDI2MDIwMl8wOTQ4JyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdzdWJzY3JpcHRpb25jb250ZXh0JywKICAgICAgICAgICAgbmFtZT0ncGF5bWVudE1ldGhvZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3N1YnNjcmlwdGlvbmNvbnRleHQnLAogICAgICAgICAgICBuYW1lPSdwcmljaW5nUnVsZScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0ncHJpY2luZ1J1bGUnLCBudWxsPVRydWUsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLlNFVF9OVUxMLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEuc3Vic2NyaXB0aW9ucGxhbnByaWNpbmdydWxlJyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdzdWJzY3JpcHRpb25jb250ZXh0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3BheW1lbnRNZXRob2QnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSdzdWJzY3JpcHRpb25jb250ZXh0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3ByaWNpbmdSdWxlJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlVVSURGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICBdCg==

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field paymentMethod to subscriptioncontext
--
ALTER TABLE "SubscriptionContext" ADD COLUMN "paymentMethod" jsonb NULL;
--
-- Add field pricingRule to subscriptioncontext
--
ALTER TABLE "SubscriptionContext" ADD COLUMN "pricingRule" uuid NULL CONSTRAINT "SubscriptionContext_pricingRule_91d5e7e9_fk_Subscript" REFERENCES "SubscriptionPlanPricingRule"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "SubscriptionContext_pricingRule_91d5e7e9_fk_Subscript" IMMEDIATE;
--
-- Add field paymentMethod to subscriptioncontexthistoryrecord
--
ALTER TABLE "SubscriptionContextHistoryRecord" ADD COLUMN "paymentMethod" jsonb NULL;
--
-- Add field pricingRule to subscriptioncontexthistoryrecord
--
ALTER TABLE "SubscriptionContextHistoryRecord" ADD COLUMN "pricingRule" uuid NULL;
CREATE INDEX "SubscriptionContext_pricingRule_91d5e7e9" ON "SubscriptionContext" ("pricingRule");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field pricingRule to subscriptioncontexthistoryrecord
--
ALTER TABLE "SubscriptionContextHistoryRecord" DROP COLUMN "pricingRule" CASCADE;
--
-- Add field paymentMethod to subscriptioncontexthistoryrecord
--
ALTER TABLE "SubscriptionContextHistoryRecord" DROP COLUMN "paymentMethod" CASCADE;
--
-- Add field pricingRule to subscriptioncontext
--
ALTER TABLE "SubscriptionContext" DROP COLUMN "pricingRule" CASCADE;
--
-- Add field paymentMethod to subscriptioncontext
--
ALTER TABLE "SubscriptionContext" DROP COLUMN "paymentMethod" CASCADE;
COMMIT;

    `)
}
