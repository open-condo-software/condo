/**
 * Generated by `createschema user.User name:Text; password?:Password; isAdmin?:Checkbox; email?:Text; isEmailVerified?:Checkbox; phone?:Text; isPhoneVerified?:Checkbox; avatar?:File; meta:Json; importId:Text;`
 */
const { throwAuthenticationError } = require('@miniapp/domains/common/utils/apolloErrorFormatter')

async function canReadUsers ({ authentication: { item: user } }) {
    if (!user) return throwAuthenticationError()
    return true
}

async function canManageUsers ({ authentication: { item: user } }) {
    if (!user) return throwAuthenticationError()
    // All users should be exported from condo API!
    // By default this service doesn't need to update User model!
    return false
}

module.exports = {
    canReadUsers,
    canManageUsers,
}
